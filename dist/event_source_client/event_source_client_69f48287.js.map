{
  "version": 3,
  "file": "event_source_client_69f48287.js",
  "sources": [
    "../../src/internal/dev_server/event_source_client/event_source_connection.js",
    "../../src/internal/dev_server/event_source_client/livereload_preference.js",
    "../../src/internal/dev_server/event_source_client/file_changes.js",
    "../../src/internal/dev_server/event_source_client/event_source_client.js"
  ],
  "sourcesContent": [
    "/* eslint-env browser */\n\nexport const createEventSourceConnection = (\n  eventSourceUrl,\n  events = {},\n  { retryMaxAttempt = Infinity, retryAllocatedMs = Infinity, lastEventId } = {},\n) => {\n  const { EventSource } = window\n  if (typeof EventSource !== \"function\") {\n    return () => {}\n  }\n\n  const eventSourceOrigin = new URL(eventSourceUrl).origin\n  Object.keys(events).forEach((eventName) => {\n    const eventCallback = events[eventName]\n    events[eventName] = (e) => {\n      if (e.origin === eventSourceOrigin) {\n        if (e.lastEventId) {\n          lastEventId = e.lastEventId\n        }\n        eventCallback(e)\n      }\n    }\n  })\n\n  let connectionStatus = \"default\"\n  let connectionStatusChangeCallback = () => {}\n  let _disconnect = () => {}\n\n  const goToStatus = (newStatus) => {\n    if (newStatus !== connectionStatus) {\n      connectionStatus = newStatus\n      connectionStatusChangeCallback()\n    }\n  }\n\n  const attemptConnection = (url) => {\n    const eventSource = new EventSource(url, {\n      withCredentials: true,\n    })\n    _disconnect = () => {\n      if (\n        connectionStatus !== \"connecting\" &&\n        connectionStatus !== \"connected\"\n      ) {\n        console.warn(\n          `disconnect() ignored because connection is ${connectionStatus}`,\n        )\n        return\n      }\n      eventSource.onerror = undefined\n      eventSource.close()\n      Object.keys(events).forEach((eventName) => {\n        eventSource.removeEventListener(eventName, events[eventName])\n      })\n      goToStatus(\"disconnected\")\n    }\n    let retryCount = 0\n    let firstRetryMs = Date.now()\n    eventSource.onerror = (errorEvent) => {\n      if (errorEvent.target.readyState === EventSource.CONNECTING) {\n        if (retryCount > retryMaxAttempt) {\n          console.info(`could not connect after ${retryMaxAttempt} attempt`)\n          _disconnect()\n          return\n        }\n\n        if (retryCount === 0) {\n          firstRetryMs = Date.now()\n        } else {\n          const allRetryDuration = Date.now() - firstRetryMs\n          if (retryAllocatedMs && allRetryDuration > retryAllocatedMs) {\n            console.info(\n              `could not connect in less than ${retryAllocatedMs} ms`,\n            )\n            _disconnect()\n            return\n          }\n        }\n\n        retryCount++\n        goToStatus(\"connecting\")\n        return\n      }\n\n      if (errorEvent.target.readyState === EventSource.CLOSED) {\n        _disconnect()\n        return\n      }\n    }\n    eventSource.onopen = () => {\n      goToStatus(\"connected\")\n    }\n    Object.keys(events).forEach((eventName) => {\n      eventSource.addEventListener(eventName, events[eventName])\n    })\n    if (!events.hasOwnProperty(\"welcome\")) {\n      eventSource.addEventListener(\"welcome\", (e) => {\n        if (e.origin === eventSourceOrigin && e.lastEventId) {\n          lastEventId = e.lastEventId\n        }\n      })\n    }\n    goToStatus(\"connecting\")\n  }\n\n  let connect = () => {\n    attemptConnection(eventSourceUrl)\n    connect = () => {\n      attemptConnection(\n        lastEventId\n          ? addLastEventIdIntoUrlSearchParams(eventSourceUrl, lastEventId)\n          : eventSourceUrl,\n      )\n    }\n  }\n\n  const removePageUnloadListener = listenPageUnload(() => {\n    _disconnect()\n  })\n\n  const destroy = () => {\n    removePageUnloadListener()\n    _disconnect()\n  }\n\n  return {\n    getConnectionStatus: () => connectionStatus,\n    setConnectionStatusChangeCallback: (callback) => {\n      connectionStatusChangeCallback = callback\n    },\n    connect,\n    disconnect: () => _disconnect(),\n    destroy,\n  }\n}\n\nconst addLastEventIdIntoUrlSearchParams = (url, lastEventId) => {\n  if (url.indexOf(\"?\") === -1) {\n    url += \"?\"\n  } else {\n    url += \"&\"\n  }\n  return `${url}last-event-id=${encodeURIComponent(lastEventId)}`\n}\n\n// const listenPageMightFreeze = (callback) => {\n//   const removePageHideListener = listenEvent(window, \"pagehide\", (pageHideEvent) => {\n//     if (pageHideEvent.persisted === true) {\n//       callback(pageHideEvent)\n//     }\n//   })\n//   return removePageHideListener\n// }\n\n// const listenPageFreeze = (callback) => {\n//   const removeFreezeListener = listenEvent(document, \"freeze\", (freezeEvent) => {\n//     callback(freezeEvent)\n//   })\n//   return removeFreezeListener\n// }\n\n// const listenPageIsRestored = (callback) => {\n//   const removeResumeListener = listenEvent(document, \"resume\", (resumeEvent) => {\n//     removePageshowListener()\n//     callback(resumeEvent)\n//   })\n//   const removePageshowListener = listenEvent(window, \"pageshow\", (pageshowEvent) => {\n//     if (pageshowEvent.persisted === true) {\n//       removePageshowListener()\n//       removeResumeListener()\n//       callback(pageshowEvent)\n//     }\n//   })\n//   return () => {\n//     removeResumeListener()\n//     removePageshowListener()\n//   }\n// }\n\nconst listenPageUnload = (callback) => {\n  const removePageHideListener = listenEvent(\n    window,\n    \"pagehide\",\n    (pageHideEvent) => {\n      if (pageHideEvent.persisted !== true) {\n        callback(pageHideEvent)\n      }\n    },\n  )\n  return removePageHideListener\n}\n\nconst listenEvent = (emitter, event, callback) => {\n  emitter.addEventListener(event, callback)\n  return () => {\n    emitter.removeEventListener(event, callback)\n  }\n}\n",
    "/* eslint-env browser */\n\nexport const isLivereloadEnabled = () => {\n  const value = window.localStorage.getItem(\"livereload\")\n  if (value === \"0\") {\n    return false\n  }\n  return true\n}\n\nexport const setLivereloadPreference = (value) => {\n  window.localStorage.setItem(\"livereload\", value ? \"1\" : \"0\")\n}\n",
    "/* eslint-env browser */\n\nimport { isLivereloadEnabled } from \"./livereload_preference.js\"\n\nlet fileChanges = {}\nlet filechangeCallback = () => {}\n\nexport const getFileChanges = () => fileChanges\n\nexport const addFileChange = ({ file, eventType }) => {\n  fileChanges[file] = eventType\n  if (isLivereloadEnabled()) {\n    reloadIfNeeded()\n  } else {\n    filechangeCallback()\n  }\n}\n\nexport const setFileChangeCallback = (callback) => {\n  filechangeCallback = callback\n}\n\nexport const reloadIfNeeded = () => {\n  const customReloads = []\n  const cssReloads = []\n  const fullReloads = []\n\n  Object.keys(fileChanges).forEach((key) => {\n    const livereloadCallback = window.__jsenv__.livereloadingCallbacks[key]\n    if (livereloadCallback) {\n      customReloads.push(() => {\n        delete fileChanges[key]\n        livereloadCallback({\n          reloadPage,\n        })\n      })\n    } else if (\n      key.endsWith(\".css\") ||\n      key.endsWith(\".scss\") ||\n      key.endsWith(\".sass\")\n    ) {\n      cssReloads.push(() => {\n        delete fileChanges[key]\n      })\n    } else {\n      fullReloads.push(key)\n    }\n  })\n\n  if (fullReloads.length > 0) {\n    reloadPage()\n    return\n  }\n\n  customReloads.forEach((customReload) => {\n    customReload()\n  })\n\n  if (cssReloads.length) {\n    reloadAllCss()\n    cssReloads.forEach((cssReload) => {\n      cssReload()\n    })\n  }\n\n  filechangeCallback()\n}\n\nconst reloadAllCss = () => {\n  const links = Array.from(window.parent.document.getElementsByTagName(\"link\"))\n  links.forEach((link) => {\n    if (link.rel === \"stylesheet\") {\n      const url = new URL(link.href)\n      url.searchParams.set(\"t\", Date.now())\n      link.href = String(url)\n    }\n  })\n}\n\nconst reloadPage = () => {\n  window.parent.location.reload(true)\n}\n",
    "/* eslint-env browser */\n\nimport { createEventSourceConnection } from \"./event_source_connection.js\"\nimport {\n  getFileChanges,\n  addFileChange,\n  setFileChangeCallback,\n  reloadIfNeeded,\n} from \"./file_changes.js\"\nimport {\n  isLivereloadEnabled,\n  setLivereloadPreference,\n} from \"./livereload_preference.js\"\n\nconst eventsourceConnection = createEventSourceConnection(\n  document.location.href,\n  {\n    \"file-added\": ({ data }) => {\n      addFileChange({\n        file: data,\n        eventType: \"added\",\n      })\n    },\n    \"file-modified\": ({ data }) => {\n      addFileChange({\n        file: data,\n        eventType: \"modified\",\n      })\n    },\n    \"file-removed\": ({ data }) => {\n      addFileChange({\n        file: data,\n        eventType: \"removed\",\n      })\n    },\n  },\n  {\n    retryMaxAttempt: Infinity,\n    retryAllocatedMs: 20 * 1000,\n  },\n)\n\nconst {\n  connect,\n  disconnect,\n  setConnectionStatusChangeCallback,\n  getConnectionStatus,\n} = eventsourceConnection\n\nconnect()\n\nwindow.__jsenv_event_source_client__ = {\n  connect,\n  disconnect,\n  getConnectionStatus,\n  setConnectionStatusChangeCallback,\n  getFileChanges,\n  addFileChange,\n  setFileChangeCallback,\n  reloadIfNeeded,\n  isLivereloadEnabled,\n  setLivereloadPreference,\n}\n"
  ],
  "names": [
    "createEventSourceConnection",
    "eventSourceUrl",
    "events",
    "retryMaxAttempt",
    "Infinity",
    "retryAllocatedMs",
    "lastEventId",
    "window",
    "EventSource",
    "eventSourceOrigin",
    "URL",
    "origin",
    "Object",
    "keys",
    "forEach",
    "eventName",
    "eventCallback",
    "e",
    "connectionStatus",
    "connectionStatusChangeCallback",
    "_disconnect",
    "goToStatus",
    "newStatus",
    "attemptConnection",
    "url",
    "eventSource",
    "withCredentials",
    "console",
    "warn",
    "onerror",
    "undefined",
    "close",
    "removeEventListener",
    "retryCount",
    "firstRetryMs",
    "Date",
    "now",
    "errorEvent",
    "target",
    "readyState",
    "CONNECTING",
    "info",
    "allRetryDuration",
    "CLOSED",
    "onopen",
    "addEventListener",
    "hasOwnProperty",
    "connect",
    "addLastEventIdIntoUrlSearchParams",
    "removePageUnloadListener",
    "listenPageUnload",
    "destroy",
    "getConnectionStatus",
    "setConnectionStatusChangeCallback",
    "callback",
    "disconnect",
    "indexOf",
    "encodeURIComponent",
    "removePageHideListener",
    "listenEvent",
    "pageHideEvent",
    "persisted",
    "emitter",
    "event",
    "isLivereloadEnabled",
    "value",
    "localStorage",
    "getItem",
    "setLivereloadPreference",
    "setItem",
    "fileChanges",
    "filechangeCallback",
    "getFileChanges",
    "addFileChange",
    "file",
    "eventType",
    "reloadIfNeeded",
    "setFileChangeCallback",
    "customReloads",
    "cssReloads",
    "fullReloads",
    "key",
    "livereloadCallback",
    "__jsenv__",
    "livereloadingCallbacks",
    "push",
    "reloadPage",
    "endsWith",
    "length",
    "customReload",
    "reloadAllCss",
    "cssReload",
    "links",
    "Array",
    "from",
    "parent",
    "document",
    "getElementsByTagName",
    "link",
    "rel",
    "href",
    "searchParams",
    "set",
    "String",
    "location",
    "reload",
    "eventsourceConnection",
    "data",
    "__jsenv_event_source_client__"
  ],
  "mappings": "AAAA;;;AAEO,IAAMA,2BAA2B,GAAG,SAA9BA,2BAA8B,CACzCC,cADyC,EAItC;AAAA,MAFHC,MAEG,uEAFM,EAEN;;AAAA,iFADwE,EACxE;AAAA,kCADDC,eACC;AAAA,MADDA,eACC,qCADiBC,QACjB;AAAA,mCAD2BC,gBAC3B;AAAA,MAD2BA,gBAC3B,sCAD8CD,QAC9C;AAAA,MADwDE,WACxD,QADwDA,WACxD;;AACH,gBAAwBC,MAAxB;AAAA,MAAQC,WAAR,WAAQA,WAAR;;AACA,MAAI,OAAOA,WAAP,KAAuB,UAA3B,EAAuC;AACrC,WAAO,YAAM,EAAb;AACD;;AAED,MAAMC,iBAAiB,GAAG,IAAIC,GAAJ,CAAQT,cAAR,EAAwBU,MAAlD;AACAC,EAAAA,MAAM,CAACC,IAAP,CAAYX,MAAZ,EAAoBY,OAApB,CAA4B,UAACC,SAAD,EAAe;AACzC,QAAMC,aAAa,GAAGd,MAAM,CAACa,SAAD,CAA5B;;AACAb,IAAAA,MAAM,CAACa,SAAD,CAAN,GAAoB,UAACE,CAAD,EAAO;AACzB,UAAIA,CAAC,CAACN,MAAF,KAAaF,iBAAjB,EAAoC;AAClC,YAAIQ,CAAC,CAACX,WAAN,EAAmB;AACjBA,UAAAA,WAAW,GAAGW,CAAC,CAACX,WAAhB;AACD;;AACDU,QAAAA,aAAa,CAACC,CAAD,CAAb;AACD;AACF,KAPD;AAQD,GAVD;AAYA,MAAIC,gBAAgB,GAAG,SAAvB;;AACA,MAAIC,8BAA8B,GAAG,0CAAM,EAA3C;;AACA,MAAIC,WAAW,GAAG,uBAAM,EAAxB;;AAEA,MAAMC,UAAU,GAAG,SAAbA,UAAa,CAACC,SAAD,EAAe;AAChC,QAAIA,SAAS,KAAKJ,gBAAlB,EAAoC;AAClCA,MAAAA,gBAAgB,GAAGI,SAAnB;AACAH,MAAAA,8BAA8B;AAC/B;AACF,GALD;;AAOA,MAAMI,iBAAiB,GAAG,SAApBA,iBAAoB,CAACC,GAAD,EAAS;AACjC,QAAMC,WAAW,GAAG,IAAIjB,WAAJ,CAAgBgB,GAAhB,EAAqB;AACvCE,MAAAA,eAAe,EAAE;AADsB,KAArB,CAApB;;AAGAN,IAAAA,WAAW,GAAG,uBAAM;AAClB,UACEF,gBAAgB,KAAK,YAArB,IACAA,gBAAgB,KAAK,WAFvB,EAGE;AACAS,QAAAA,OAAO,CAACC,IAAR,sDACgDV,gBADhD;AAGA;AACD;;AACDO,MAAAA,WAAW,CAACI,OAAZ,GAAsBC,SAAtB;AACAL,MAAAA,WAAW,CAACM,KAAZ;AACAnB,MAAAA,MAAM,CAACC,IAAP,CAAYX,MAAZ,EAAoBY,OAApB,CAA4B,UAACC,SAAD,EAAe;AACzCU,QAAAA,WAAW,CAACO,mBAAZ,CAAgCjB,SAAhC,EAA2Cb,MAAM,CAACa,SAAD,CAAjD;AACD,OAFD;AAGAM,MAAAA,UAAU,CAAC,cAAD,CAAV;AACD,KAhBD;;AAiBA,QAAIY,UAAU,GAAG,CAAjB;AACA,QAAIC,YAAY,GAAGC,IAAI,CAACC,GAAL,EAAnB;;AACAX,IAAAA,WAAW,CAACI,OAAZ,GAAsB,UAACQ,UAAD,EAAgB;AACpC,UAAIA,UAAU,CAACC,MAAX,CAAkBC,UAAlB,KAAiC/B,WAAW,CAACgC,UAAjD,EAA6D;AAC3D,YAAIP,UAAU,GAAG9B,eAAjB,EAAkC;AAChCwB,UAAAA,OAAO,CAACc,IAAR,mCAAwCtC,eAAxC;;AACAiB,UAAAA,WAAW;;AACX;AACD;;AAED,YAAIa,UAAU,KAAK,CAAnB,EAAsB;AACpBC,UAAAA,YAAY,GAAGC,IAAI,CAACC,GAAL,EAAf;AACD,SAFD,MAEO;AACL,cAAMM,gBAAgB,GAAGP,IAAI,CAACC,GAAL,KAAaF,YAAtC;;AACA,cAAI7B,gBAAgB,IAAIqC,gBAAgB,GAAGrC,gBAA3C,EAA6D;AAC3DsB,YAAAA,OAAO,CAACc,IAAR,0CACoCpC,gBADpC;;AAGAe,YAAAA,WAAW;;AACX;AACD;AACF;;AAEDa,QAAAA,UAAU;AACVZ,QAAAA,UAAU,CAAC,YAAD,CAAV;AACA;AACD;;AAED,UAAIgB,UAAU,CAACC,MAAX,CAAkBC,UAAlB,KAAiC/B,WAAW,CAACmC,MAAjD,EAAyD;AACvDvB,QAAAA,WAAW;;AACX;AACD;AACF,KA9BD;;AA+BAK,IAAAA,WAAW,CAACmB,MAAZ,GAAqB,YAAM;AACzBvB,MAAAA,UAAU,CAAC,WAAD,CAAV;AACD,KAFD;;AAGAT,IAAAA,MAAM,CAACC,IAAP,CAAYX,MAAZ,EAAoBY,OAApB,CAA4B,UAACC,SAAD,EAAe;AACzCU,MAAAA,WAAW,CAACoB,gBAAZ,CAA6B9B,SAA7B,EAAwCb,MAAM,CAACa,SAAD,CAA9C;AACD,KAFD;;AAGA,QAAI,CAACb,MAAM,CAAC4C,cAAP,CAAsB,SAAtB,CAAL,EAAuC;AACrCrB,MAAAA,WAAW,CAACoB,gBAAZ,CAA6B,SAA7B,EAAwC,UAAC5B,CAAD,EAAO;AAC7C,YAAIA,CAAC,CAACN,MAAF,KAAaF,iBAAb,IAAkCQ,CAAC,CAACX,WAAxC,EAAqD;AACnDA,UAAAA,WAAW,GAAGW,CAAC,CAACX,WAAhB;AACD;AACF,OAJD;AAKD;;AACDe,IAAAA,UAAU,CAAC,YAAD,CAAV;AACD,GApED;;AAsEA,MAAI0B,QAAO,GAAG,mBAAM;AAClBxB,IAAAA,iBAAiB,CAACtB,cAAD,CAAjB;;AACA8C,IAAAA,QAAO,GAAG,mBAAM;AACdxB,MAAAA,iBAAiB,CACfjB,WAAW,GACP0C,iCAAiC,CAAC/C,cAAD,EAAiBK,WAAjB,CAD1B,GAEPL,cAHW,CAAjB;AAKD,KAND;AAOD,GATD;;AAWA,MAAMgD,wBAAwB,GAAGC,gBAAgB,CAAC,YAAM;AACtD9B,IAAAA,WAAW;AACZ,GAFgD,CAAjD;;AAIA,MAAM+B,OAAO,GAAG,SAAVA,OAAU,GAAM;AACpBF,IAAAA,wBAAwB;;AACxB7B,IAAAA,WAAW;AACZ,GAHD;;AAKA,SAAO;AACLgC,IAAAA,mBAAmB,EAAE;AAAA,aAAMlC,gBAAN;AAAA,KADhB;AAELmC,IAAAA,iCAAiC,EAAE,2CAACC,QAAD,EAAc;AAC/CnC,MAAAA,8BAA8B,GAAGmC,QAAjC;AACD,KAJI;AAKLP,IAAAA,OAAO,EAAPA,QALK;AAMLQ,IAAAA,UAAU,EAAE;AAAA,aAAMnC,WAAW,EAAjB;AAAA,KANP;AAOL+B,IAAAA,OAAO,EAAPA;AAPK,GAAP;AASD,CArIM;;AAuIP,IAAMH,iCAAiC,GAAG,SAApCA,iCAAoC,CAACxB,GAAD,EAAMlB,WAAN,EAAsB;AAC9D,MAAIkB,GAAG,CAACgC,OAAJ,CAAY,GAAZ,MAAqB,CAAC,CAA1B,EAA6B;AAC3BhC,IAAAA,GAAG,IAAI,GAAP;AACD,GAFD,MAEO;AACLA,IAAAA,GAAG,IAAI,GAAP;AACD;;AACD,mBAAUA,GAAV,2BAA8BiC,kBAAkB,CAACnD,WAAD,CAAhD;AACD,CAPD;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA,IAAM4C,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACI,QAAD,EAAc;AACrC,MAAMI,sBAAsB,GAAGC,WAAW,CACxCpD,MADwC,EAExC,UAFwC,EAGxC,UAACqD,aAAD,EAAmB;AACjB,QAAIA,aAAa,CAACC,SAAd,KAA4B,IAAhC,EAAsC;AACpCP,MAAAA,QAAQ,CAACM,aAAD,CAAR;AACD;AACF,GAPuC,CAA1C;AASA,SAAOF,sBAAP;AACD,CAXD;;AAaA,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAACG,OAAD,EAAUC,KAAV,EAAiBT,QAAjB,EAA8B;AAChDQ,EAAAA,OAAO,CAACjB,gBAAR,CAAyBkB,KAAzB,EAAgCT,QAAhC;AACA,SAAO,YAAM;AACXQ,IAAAA,OAAO,CAAC9B,mBAAR,CAA4B+B,KAA5B,EAAmCT,QAAnC;AACD,GAFD;AAGD,CALD;;ACjMA;AAEO,IAAMU,mBAAmB,GAAG,SAAtBA,mBAAsB,GAAM;AACvC,MAAMC,KAAK,GAAG1D,MAAM,CAAC2D,YAAP,CAAoBC,OAApB,CAA4B,YAA5B,CAAd;;AACA,MAAIF,KAAK,KAAK,GAAd,EAAmB;AACjB,WAAO,KAAP;AACD;;AACD,SAAO,IAAP;AACD,CANM;AAQA,IAAMG,uBAAuB,GAAG,SAA1BA,uBAA0B,CAACH,KAAD,EAAW;AAChD1D,EAAAA,MAAM,CAAC2D,YAAP,CAAoBG,OAApB,CAA4B,YAA5B,EAA0CJ,KAAK,GAAG,GAAH,GAAS,GAAxD;AACD,CAFM;;ACVP;AAIA,IAAIK,WAAW,GAAG,EAAlB;;AACA,IAAIC,kBAAkB,GAAG,8BAAM,EAA/B;;AAEO,IAAMC,cAAc,GAAG,SAAjBA,cAAiB;AAAA,SAAMF,WAAN;AAAA,CAAvB;AAEA,IAAMG,aAAa,GAAG,SAAhBA,aAAgB,OAAyB;AAAA,MAAtBC,IAAsB,QAAtBA,IAAsB;AAAA,MAAhBC,SAAgB,QAAhBA,SAAgB;AACpDL,EAAAA,WAAW,CAACI,IAAD,CAAX,GAAoBC,SAApB;;AACA,MAAIX,mBAAmB,EAAvB,EAA2B;AACzBY,IAAAA,cAAc;AACf,GAFD,MAEO;AACLL,IAAAA,kBAAkB;AACnB;AACF,CAPM;AASA,IAAMM,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACvB,QAAD,EAAc;AACjDiB,EAAAA,kBAAkB,GAAGjB,QAArB;AACD,CAFM;AAIA,IAAMsB,cAAc,GAAG,SAAjBA,cAAiB,GAAM;AAClC,MAAME,aAAa,GAAG,EAAtB;AACA,MAAMC,UAAU,GAAG,EAAnB;AACA,MAAMC,WAAW,GAAG,EAApB;AAEApE,EAAAA,MAAM,CAACC,IAAP,CAAYyD,WAAZ,EAAyBxD,OAAzB,CAAiC,UAACmE,GAAD,EAAS;AACxC,QAAMC,kBAAkB,GAAG3E,MAAM,CAAC4E,SAAP,CAAiBC,sBAAjB,CAAwCH,GAAxC,CAA3B;;AACA,QAAIC,kBAAJ,EAAwB;AACtBJ,MAAAA,aAAa,CAACO,IAAd,CAAmB,YAAM;AACvB,eAAOf,WAAW,CAACW,GAAD,CAAlB;AACAC,QAAAA,kBAAkB,CAAC;AACjBI,UAAAA,UAAU,EAAVA;AADiB,SAAD,CAAlB;AAGD,OALD;AAMD,KAPD,MAOO,IACLL,GAAG,CAACM,QAAJ,CAAa,MAAb,KACAN,GAAG,CAACM,QAAJ,CAAa,OAAb,CADA,IAEAN,GAAG,CAACM,QAAJ,CAAa,OAAb,CAHK,EAIL;AACAR,MAAAA,UAAU,CAACM,IAAX,CAAgB,YAAM;AACpB,eAAOf,WAAW,CAACW,GAAD,CAAlB;AACD,OAFD;AAGD,KARM,MAQA;AACLD,MAAAA,WAAW,CAACK,IAAZ,CAAiBJ,GAAjB;AACD;AACF,GApBD;;AAsBA,MAAID,WAAW,CAACQ,MAAZ,GAAqB,CAAzB,EAA4B;AAC1BF,IAAAA,UAAU;AACV;AACD;;AAEDR,EAAAA,aAAa,CAAChE,OAAd,CAAsB,UAAC2E,YAAD,EAAkB;AACtCA,IAAAA,YAAY;AACb,GAFD;;AAIA,MAAIV,UAAU,CAACS,MAAf,EAAuB;AACrBE,IAAAA,YAAY;AACZX,IAAAA,UAAU,CAACjE,OAAX,CAAmB,UAAC6E,SAAD,EAAe;AAChCA,MAAAA,SAAS;AACV,KAFD;AAGD;;AAEDpB,EAAAA,kBAAkB;AACnB,CA5CM;;AA8CP,IAAMmB,YAAY,GAAG,SAAfA,YAAe,GAAM;AACzB,MAAME,KAAK,GAAGC,KAAK,CAACC,IAAN,CAAWvF,MAAM,CAACwF,MAAP,CAAcC,QAAd,CAAuBC,oBAAvB,CAA4C,MAA5C,CAAX,CAAd;AACAL,EAAAA,KAAK,CAAC9E,OAAN,CAAc,UAACoF,IAAD,EAAU;AACtB,QAAIA,IAAI,CAACC,GAAL,KAAa,YAAjB,EAA+B;AAC7B,UAAM3E,GAAG,GAAG,IAAId,GAAJ,CAAQwF,IAAI,CAACE,IAAb,CAAZ;AACA5E,MAAAA,GAAG,CAAC6E,YAAJ,CAAiBC,GAAjB,CAAqB,GAArB,EAA0BnE,IAAI,CAACC,GAAL,EAA1B;AACA8D,MAAAA,IAAI,CAACE,IAAL,GAAYG,MAAM,CAAC/E,GAAD,CAAlB;AACD;AACF,GAND;AAOD,CATD;;AAWA,IAAM8D,UAAU,GAAG,SAAbA,UAAa,GAAM;AACvB/E,EAAAA,MAAM,CAACwF,MAAP,CAAcS,QAAd,CAAuBC,MAAvB,CAA8B,IAA9B;AACD,CAFD;;AC/EA;AAcA,IAAMC,qBAAqB,GAAG1G,2BAA2B,CACvDgG,QAAQ,CAACQ,QAAT,CAAkBJ,IADqC,EAEvD;AACE,gBAAc,yBAAc;AAAA,QAAXO,IAAW,QAAXA,IAAW;AAC1BlC,IAAAA,aAAa,CAAC;AACZC,MAAAA,IAAI,EAAEiC,IADM;AAEZhC,MAAAA,SAAS,EAAE;AAFC,KAAD,CAAb;AAID,GANH;AAOE,mBAAiB,6BAAc;AAAA,QAAXgC,IAAW,SAAXA,IAAW;AAC7BlC,IAAAA,aAAa,CAAC;AACZC,MAAAA,IAAI,EAAEiC,IADM;AAEZhC,MAAAA,SAAS,EAAE;AAFC,KAAD,CAAb;AAID,GAZH;AAaE,kBAAgB,4BAAc;AAAA,QAAXgC,IAAW,SAAXA,IAAW;AAC5BlC,IAAAA,aAAa,CAAC;AACZC,MAAAA,IAAI,EAAEiC,IADM;AAEZhC,MAAAA,SAAS,EAAE;AAFC,KAAD,CAAb;AAID;AAlBH,CAFuD,EAsBvD;AACExE,EAAAA,eAAe,EAAEC,QADnB;AAEEC,EAAAA,gBAAgB,EAAE,KAAK;AAFzB,CAtBuD,CAAzD;AA4BA,IACE0C,OADF,GAKI2D,qBALJ,CACE3D,OADF;AAAA,IAEEQ,UAFF,GAKImD,qBALJ,CAEEnD,UAFF;AAAA,IAGEF,iCAHF,GAKIqD,qBALJ,CAGErD,iCAHF;AAAA,IAIED,mBAJF,GAKIsD,qBALJ,CAIEtD,mBAJF;AAOAL,OAAO;AAEPxC,MAAM,CAACqG,6BAAP,GAAuC;AACrC7D,EAAAA,OAAO,EAAPA,OADqC;AAErCQ,EAAAA,UAAU,EAAVA,UAFqC;AAGrCH,EAAAA,mBAAmB,EAAnBA,mBAHqC;AAIrCC,EAAAA,iCAAiC,EAAjCA,iCAJqC;AAKrCmB,EAAAA,cAAc,EAAdA,cALqC;AAMrCC,EAAAA,aAAa,EAAbA,aANqC;AAOrCI,EAAAA,qBAAqB,EAArBA,qBAPqC;AAQrCD,EAAAA,cAAc,EAAdA,cARqC;AASrCZ,EAAAA,mBAAmB,EAAnBA,mBATqC;AAUrCI,EAAAA,uBAAuB,EAAvBA;AAVqC,CAAvC"
}