{
  "version": 3,
  "file": "html_supervisor_setup.js",
  "sources": [
    "../src/plugins/html_supervisor/client/html_supervisor_setup.js"
  ],
  "sourcesContent": [
    "window.__html_supervisor__ = {\n  // \"html_supervisor_installer.js\" will implement\n  // - \"addScriptToExecute\"\n  // - \"superviseScriptTypeModule\"\n  // - \"collectScriptResults\"\n  // and take all executions in \"scriptsToExecute\" and implement their supervision\n  scriptsToExecute: [],\n  addScriptToExecute: (scriptToExecute) => {\n    window.__html_supervisor__.scriptsToExecute.push(scriptToExecute)\n  },\n  superviseScript: ({ src, isInline, crossorigin, integrity }) => {\n    window.__html_supervisor__.addScriptToExecute({\n      src,\n      type: \"js_classic\",\n      isInline,\n      currentScript: document.currentScript,\n      execute: () => {\n        return new Promise((resolve, reject) => {\n          const script = document.createElement(\"script\")\n          if (crossorigin) {\n            script.crossorigin = crossorigin\n          }\n          if (integrity) {\n            script.integrity = integrity\n          }\n          script.src = src\n          const scriptUrl = new URL(src, window.location).href\n          let lastWindowErrorUrl\n          let lastWindowError\n          const windowErrorCallback = (e) => {\n            lastWindowErrorUrl = e.filename\n            lastWindowError = e.error\n          }\n          const cleanup = () => {\n            document.body.removeChild(script)\n            window.removeEventListener(\"error\", windowErrorCallback)\n          }\n          window.addEventListener(\"error\", windowErrorCallback)\n          script.addEventListener(\"error\", () => {\n            cleanup()\n            reject(src)\n          })\n          script.addEventListener(\"load\", () => {\n            cleanup()\n            if (lastWindowErrorUrl === scriptUrl) {\n              reject(lastWindowError)\n            } else {\n              resolve()\n            }\n          })\n          document.body.appendChild(script)\n        })\n      },\n    })\n  },\n  superviseScriptTypeModule: () => {\n    throw new Error(\"htmlSupervisor not installed\")\n  },\n  getScriptExecutionResults: () => {\n    // wait for page to load before collecting script execution results\n    const htmlReadyPromise = new Promise((resolve) => {\n      if (document.readyState === \"complete\") {\n        resolve()\n        return\n      }\n      const loadCallback = () => {\n        window.removeEventListener(\"load\", loadCallback)\n        resolve()\n      }\n      window.addEventListener(\"load\", loadCallback)\n    })\n    return htmlReadyPromise.then(() => {\n      return window.__html_supervisor__.collectScriptResults()\n    })\n  },\n  collectScriptResults: () => {\n    throw new Error(\"htmlSupervisor not installed\")\n  },\n}\n"
  ],
  "names": [
    "window",
    "__html_supervisor__",
    "scriptsToExecute",
    "addScriptToExecute",
    "scriptToExecute",
    "push",
    "superviseScript",
    "src",
    "isInline",
    "crossorigin",
    "integrity",
    "type",
    "currentScript",
    "document",
    "execute",
    "Promise",
    "resolve",
    "reject",
    "script",
    "createElement",
    "scriptUrl",
    "URL",
    "location",
    "href",
    "lastWindowErrorUrl",
    "lastWindowError",
    "windowErrorCallback",
    "e",
    "filename",
    "error",
    "cleanup",
    "body",
    "removeChild",
    "removeEventListener",
    "addEventListener",
    "appendChild",
    "superviseScriptTypeModule",
    "Error",
    "getScriptExecutionResults",
    "htmlReadyPromise",
    "readyState",
    "loadCallback",
    "then",
    "collectScriptResults"
  ],
  "mappings": "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"
}