{
  "version": 3,
  "file": "html_supervisor_setup.js",
  "sources": [
    "../src/plugins/html_supervisor/client/html_supervisor_setup.js"
  ],
  "sourcesContent": [
    "window.__html_supervisor__ = {\n  // \"html_supervisor_installer.js\" will implement\n  // - \"addExecution\"\n  // - \"collectScriptResults\"\n  // - \"superviseScriptTypeModule\"\n  // and take all executions in \"executions\" and implement their supervision\n  executions: [],\n  addExecution: (execution) => {\n    window.__html_supervisor__.executions.push(execution)\n  },\n  collectScriptResults: () => {\n    throw new Error(\"htmlSupervisor not installed\")\n  },\n  superviseScriptTypeModule: () => {\n    throw new Error(\"htmlSupervisor not installed\")\n  },\n  superviseScript: ({ src, crossorigin, integrity }) => {\n    window.__html_supervisor__.addExecution({\n      type: \"js_classic\",\n      improveErrorWithFetch: true,\n      currentScript: document.currentScript,\n      src,\n      promise: new Promise((resolve, reject) => {\n        const script = document.createElement(\"script\")\n        if (crossorigin) {\n          script.crossorigin = crossorigin\n        }\n        if (integrity) {\n          script.integrity = integrity\n        }\n        script.src = src\n        const scriptUrl = new URL(src, window.location).href\n        let lastWindowErrorUrl\n        let lastWindowError\n        const windowErrorCallback = (e) => {\n          lastWindowErrorUrl = e.filename\n          lastWindowError = e.error\n        }\n        const cleanup = () => {\n          document.body.removeChild(script)\n          window.removeEventListener(\"error\", windowErrorCallback)\n        }\n        window.addEventListener(\"error\", windowErrorCallback)\n        script.addEventListener(\"error\", () => {\n          cleanup()\n          reject(src)\n        })\n        script.addEventListener(\"load\", () => {\n          cleanup()\n          if (lastWindowErrorUrl === scriptUrl) {\n            reject(lastWindowError)\n          } else {\n            resolve()\n          }\n        })\n        document.body.appendChild(script)\n      }),\n    })\n  },\n  getScriptExecutionResults: () => {\n    // wait for page to load before collecting script execution results\n    const htmlReadyPromise = new Promise((resolve) => {\n      if (document.readyState === \"complete\") {\n        resolve()\n        return\n      }\n      const loadCallback = () => {\n        window.removeEventListener(\"load\", loadCallback)\n        resolve()\n      }\n      window.addEventListener(\"load\", loadCallback)\n    })\n    return htmlReadyPromise.then(() => {\n      return window.__html_supervisor__.collectScriptResults()\n    })\n  },\n}\n"
  ],
  "names": [
    "window",
    "__html_supervisor__",
    "executions",
    "addExecution",
    "execution",
    "push",
    "collectScriptResults",
    "Error",
    "superviseScriptTypeModule",
    "superviseScript",
    "src",
    "crossorigin",
    "integrity",
    "type",
    "improveErrorWithFetch",
    "currentScript",
    "document",
    "promise",
    "Promise",
    "resolve",
    "reject",
    "script",
    "createElement",
    "scriptUrl",
    "URL",
    "location",
    "href",
    "lastWindowErrorUrl",
    "lastWindowError",
    "windowErrorCallback",
    "e",
    "filename",
    "error",
    "cleanup",
    "body",
    "removeChild",
    "removeEventListener",
    "addEventListener",
    "appendChild",
    "getScriptExecutionResults",
    "htmlReadyPromise",
    "readyState",
    "loadCallback",
    "then"
  ],
  "mappings": "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"
}