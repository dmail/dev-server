{
  "version": 3,
  "sources": [
    "../index.js"
  ],
  "names": [
    "createModuleRunner",
    "params",
    "then",
    "server",
    "runInsideNode",
    "file",
    "rest",
    "nodeClient",
    "execute",
    "runInsideChromium",
    "headless",
    "cover",
    "compileURL",
    "chromiumClient",
    "collectCoverage",
    "promise"
  ],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;AAQO,MAAMA,kBAAkB,GAAIC,MAAD,IAAY;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,SAAO,0CAAkBA,MAAlB,EAA0BC,IAA1B,CAAgCC,MAAD,IAAY;AAChD,UAAMC,aAAa,GAAG,UAAuB;AAAA,UAAtB;AAAEC,QAAAA;AAAF,OAAsB;AAAA,UAAXC,IAAW;;AAC3C,aAAO,oCAAe;AAAEH,QAAAA;AAAF,OAAf,EAA2BD,IAA3B,CAAiCK,UAAD,IAAgB;AACrD;AACA,eAAOA,UAAU,CAACC,OAAX;AACLH,UAAAA;AADK,WAEFC,IAFE,EAAP;AAID,OANM,CAAP;AAOD,KARD;;AAUA,UAAMG,iBAAiB,GAAG,CAAC;AAAEJ,MAAAA,IAAF;AAAQK,MAAAA,QAAQ,GAAG,IAAnB;AAAyBC,MAAAA,KAAK,GAAG;AAAjC,KAAD,KAA8C;AACtE,aAAO,4CAAmB;AACxBC,QAAAA,UAAU,EAAET,MAAM,CAACS,UADK;AAExBF,QAAAA;AAFwB,OAAnB,EAGJR,IAHI,CAGEW,cAAD,IAAoB;AAC1B,eAAOA,cAAc,CAClBL,OADI,CACI;AACPH,UAAAA,IADO;AAEPS,UAAAA,eAAe,EAAEH;AAFV,SADJ,EAKJT,IALI,CAKC,CAAC;AAAEa,UAAAA;AAAF,SAAD,KAAiBA,OALlB,CAAP;AAMD,OAVM,CAAP;AAWD,KAZD;;AAcA,WAAO;AAAEX,MAAAA,aAAF;AAAiBK,MAAAA;AAAjB,KAAP;AACD,GA1BM,CAAP;AA2BD,CAtCM",
  "sourcesContent": [
    "// https://github.com/jsenv/core/blob/master/src/api/api.js\n// https://github.com/ModuleLoader/system-register-loader/blob/master/src/system-register-loader.js\n\n// pour le coverage\n// https://github.com/jsenv/core/blob/master/more/test/playground/coverage/run.js\n// https://github.com/jsenv/core/blob/master/more/to-externalize/module-cover/index.js\n\nimport { openChromiumClient } from \"./src/openChromiumClient/openChromiumClient.js\"\nimport { openCompileServer } from \"./src/openCompileServer/openCompileServer.js\"\nimport { openNodeClient } from \"./src/openNodeClient/openNodeClient.js\"\nimport { openBrowserServer } from \"./src/openBrowserServer/openBrowserServer.js\"\nimport { testProject, createCoverageFromTestReport } from \"./src/coverFolder/coverFolder.js\"\nimport { run } from \"./src/run/run.js\"\n\nexport { testProject, createCoverageFromTestReport }\nexport { openCompileServer }\nexport { openBrowserServer }\nexport { openChromiumClient }\nexport { run }\n\nexport const createModuleRunner = (params) => {\n  // if there is already a compileServer running for that location\n  // they will work as long as the code which created them run in the same terminal\n  // if two terminal spawns a server trying to compile a given project they will concurrently\n  // read/write filesystem.\n  // To fix that we could:\n  // - update createLock.js so that, somehow, it can lock calls from different terminals\n  // - save somewhere the port used for that specific project and reuse when existing\n  // save used port is the easiest solution but we'll ignore this issue for now\n  // and assume noone will try to open two server for the same location\n\n  return openCompileServer(params).then((server) => {\n    const runInsideNode = ({ file, ...rest }) => {\n      return openNodeClient({ server }).then((nodeClient) => {\n        // we should return a way to close?\n        return nodeClient.execute({\n          file,\n          ...rest,\n        })\n      })\n    }\n\n    const runInsideChromium = ({ file, headless = true, cover = false }) => {\n      return openChromiumClient({\n        compileURL: server.compileURL,\n        headless,\n      }).then((chromiumClient) => {\n        return chromiumClient\n          .execute({\n            file,\n            collectCoverage: cover,\n          })\n          .then(({ promise }) => promise)\n      })\n    }\n\n    return { runInsideNode, runInsideChromium }\n  })\n}\n"
  ]
}