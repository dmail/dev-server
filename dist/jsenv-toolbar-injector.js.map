{
  "version": 3,
  "file": "jsenv-toolbar-injector.js",
  "sources": [
    "../helpers/babel/typeof/typeof.js",
    "../src/internal/bundling/import-meta-global.js",
    "../src/internal/toolbar/util/dom.js",
    "../src/internal/toolbar/toolbar.injector.js"
  ],
  "sourcesContent": [
    "const nativeTypeOf = (obj) => typeof obj\n\nconst customTypeOf = (obj) => {\n  return obj &&\n    typeof Symbol === \"function\" &&\n    obj.constructor === Symbol &&\n    obj !== Symbol.prototype\n    ? \"symbol\"\n    : typeof obj\n}\n\nexport default typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\"\n  ? nativeTypeOf\n  : customTypeOf\n",
    "// eslint-disable-next-line import/no-unresolved\nimport importMap from \"/jsenv.importmap\"\nimport { normalizeImportMap } from \"@jsenv/import-map/src/normalizeImportMap.js\"\nimport { resolveImport } from \"@jsenv/import-map/src/resolveImport.js\"\n\nconst getCurrentScriptSrc = () => {\n  const { currentScript } = document\n  if (currentScript) return currentScript.src\n\n  // https://github.com/amiller-gh/currentScript-polyfill\n\n  const scripts = Array.prototype.slice.call(document.getElementsByTagName(\"script\"))\n\n  const readyScript = scripts.find((script) => {\n    return script.readyState === \"interactive\"\n  })\n  if (readyScript) return readyScript\n\n  try {\n    throw new Error()\n  } catch (err) {\n    // Find the second match for the \"at\" string to get file src url from stack.\n    // Specifically works with the format of stack traces in IE.\n    const stackDetails = /.*at [^(]*\\((.*):(.+):(.+)\\)$/gi.exec(err.stack)\n    const scriptLocation = (stackDetails || [false])[1]\n    const line = (stackDetails || [false])[2]\n    const currentLocation = document.location.href.replace(document.location.hash, \"\")\n\n    if (scriptLocation === currentLocation) {\n      const source = document.documentElement.outerHTML\n      const codeRegExp = new RegExp(\n        `(?:[^\\\\n]+?\\\\n){0,${line - 2}}[^<]*<script>([\\\\d\\\\D]*?)<\\\\/script>[\\\\d\\\\D]*`,\n        \"i\",\n      )\n      const code = source.replace(codeRegExp, \"$1\").trim()\n\n      return scripts.find((script) => {\n        return script.innerHTML && script.innerHTML.trim() === code\n      })\n    }\n\n    return scripts.find((script) => {\n      return script.src === scriptLocation\n    })\n  }\n}\n\nexport const url = getCurrentScriptSrc()\n\nexport const resolve = (specifier) => {\n  return Promise.resolve(\n    resolveImport({\n      specifier,\n      importer: url,\n      importMap: memoizedGetImportMap(),\n      defaultExtension: false,\n    }),\n  )\n}\n\n// better for perf and helps rollup to tree shake this out\n// when import.meta.resolve is not used\nlet memoizedImportMap\nconst memoizedGetImportMap = () => {\n  if (memoizedImportMap) return memoizedImportMap\n  memoizedImportMap = normalizeImportMap(importMap, url)\n  return memoizedImportMap\n}\n",
    "export const updateIframeOverflowOnParentWindow = () => {\n  const aTooltipIsOpened =\n    document.querySelector(\"[data-tooltip-visible]\") ||\n    document.querySelector(\"[data-tooltip-auto-visible]\")\n  const settingsAreOpened = document.querySelector(\"#settings[data-active]\")\n\n  if (aTooltipIsOpened || settingsAreOpened) {\n    enableIframeOverflowOnParentWindow()\n  } else {\n    disableIframeOverflowOnParentWindow()\n  }\n}\n\nconst enableIframeOverflowOnParentWindow = () => {\n  const iframe = getToolbarIframe()\n  const transitionDuration = iframe.style.transitionDuration\n  setStyles(iframe, { \"height\": \"100%\", \"transition-duration\": \"0ms\" })\n  if (transitionDuration) {\n    setTimeout(() => {\n      setStyles(iframe, { \"transition-duration\": transitionDuration })\n    })\n  }\n}\n\nconst disableIframeOverflowOnParentWindow = () => {\n  const iframe = getToolbarIframe()\n  const transitionDuration = iframe.style.transitionDuration\n  setStyles(iframe, { \"height\": \"40px\", \"transition-duration\": \"0ms\" })\n  if (transitionDuration) {\n    setTimeout(() => {\n      setStyles(iframe, { \"transition-duration\": transitionDuration })\n    })\n  }\n}\n\nexport const getToolbarIframe = () => {\n  const iframes = Array.from(window.parent.document.querySelectorAll(\"iframe\"))\n  return iframes.find((iframe) => iframe.contentWindow === window)\n}\n\nexport const forceHideElement = (element) => {\n  element.setAttribute(\"data-force-hide\", \"\")\n}\n\nexport const removeForceHideElement = (element) => {\n  element.removeAttribute(\"data-force-hide\")\n}\n\nexport const setStyles = (element, styles) => {\n  const elementStyle = element.style\n  const restoreStyles = Object.keys(styles).map((styleName) => {\n    let restore\n    if (styleName in elementStyle) {\n      const currentStyle = elementStyle[styleName]\n      restore = () => {\n        elementStyle[styleName] = currentStyle\n      }\n    } else {\n      restore = () => {\n        delete elementStyle[styleName]\n      }\n    }\n\n    elementStyle[styleName] = styles[styleName]\n\n    return restore\n  })\n  return () => {\n    restoreStyles.forEach((restore) => restore())\n  }\n}\n\nexport const setAttributes = (element, attributes) => {\n  Object.keys(attributes).forEach((name) => {\n    element.setAttribute(name, attributes[name])\n  })\n}\n\nexport const getDocumentScroll = () => {\n  return {\n    x: document.documentElement.scrollLeft,\n    y: document.documentElement.scrollTop,\n  }\n}\n\nexport const toolbarSectionIsActive = (element) => {\n  return element.hasAttribute(\"data-active\")\n}\n\nexport const activateToolbarSection = (element) => {\n  element.setAttribute(\"data-active\", \"\")\n}\n\nexport const deactivateToolbarSection = (element) => {\n  element.removeAttribute(\"data-active\")\n}\n",
    "import { setAttributes, setStyles } from \"./util/dom.js\"\n\n/*\nWe must connect to livereload server asap so that if a file is modified\nwhile page is loading we are notified of it.\n\nOtherwise it's possible that a file is loaded and used by browser then its modified before\nlivereload connection is established.\n\nWhen toolbar is loaded it will open an other connection to server sent events and close this one.\n*/\nconst connectLivereload = () => {\n  const { EventSource } = window\n  if (typeof EventSource !== \"function\") {\n    return () => {}\n  }\n\n  const getLivereloadPreference = () => {\n    return localStorage.hasOwnProperty(\"livereload\")\n      ? JSON.parse(localStorage.getItem(\"livereload\"))\n      : true\n  }\n\n  const url = document.location.href\n  let isOpen = false\n  let lastEventId\n  const latestChangeMap = {}\n\n  const events = {\n    \"file-modified\": ({ data }) => {\n      latestChangeMap[data] = \"modified\"\n      if (getLivereloadPreference()) {\n        window.location.reload(true)\n      }\n    },\n    \"file-removed\": ({ data }) => {\n      latestChangeMap[data] = \"removed\"\n      if (getLivereloadPreference()) {\n        window.location.reload(true)\n      }\n    },\n    \"file-added\": ({ data }) => {\n      latestChangeMap[data] = \"added\"\n      if (getLivereloadPreference()) {\n        window.location.reload(true)\n      }\n    },\n  }\n\n  const eventSourceOrigin = new URL(url).origin\n  const eventSource = new EventSource(url, {\n    withCredentials: true,\n  })\n\n  const disconnect = () => {\n    eventSource.close()\n  }\n\n  eventSource.onopen = () => {\n    isOpen = true\n  }\n\n  eventSource.onerror = (errorEvent) => {\n    if (errorEvent.target.readyState === EventSource.CLOSED) {\n      isOpen = false\n    }\n  }\n\n  Object.keys(events).forEach((eventName) => {\n    eventSource.addEventListener(eventName, (e) => {\n      if (e.origin === eventSourceOrigin) {\n        if (e.lastEventId) {\n          lastEventId = e.lastEventId\n        }\n        events[eventName](e)\n      }\n    })\n  })\n\n  return () => {\n    return {\n      isOpen,\n      latestChangeMap,\n      lastEventId,\n      disconnect,\n    }\n  }\n}\n// eslint-disable-next-line camelcase\nwindow.__jsenv_eventsource__ = connectLivereload()\n\nconst injectToolbar = async () => {\n  const placeholder = getToolbarPlaceholder()\n\n  const iframe = document.createElement(\"iframe\")\n  setAttributes(iframe, {\n    tabindex: -1,\n    // sandbox: \"allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-same-origin allow-scripts allow-top-navigation-by-user-activation\",\n    // allow: \"accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; microphone; midi; payment; vr\",\n    allowtransparency: true,\n  })\n  setStyles(iframe, {\n    position: \"fixed\",\n    zIndex: 1000,\n    bottom: 0,\n    left: 0,\n    width: \"100%\",\n    height: 0,\n    /* ensure toolbar children are not focusable when hidden */\n    visibility: \"hidden\",\n    border: \"none\",\n  })\n  const iframeLoadedPromise = iframeToLoadedPromise(iframe)\n  // set iframe src BEFORE putting it into the DOM (prevent firefox adding an history entry)\n  iframe.setAttribute(\"src\", new URL(\"./internal/toolbar/toolbar.html\", import.meta.url))\n  placeholder.parentNode.replaceChild(iframe, placeholder)\n\n  await iframeLoadedPromise\n  iframe.removeAttribute(\"tabindex\")\n\n  const listenToolbarIframeEvent = (event, fn) => {\n    window.addEventListener(\n      \"message\",\n      (messageEvent) => {\n        const { data } = messageEvent\n        if (typeof data !== \"object\") return\n        const { jsenv } = data\n        if (!jsenv) return\n        const { type } = data\n        if (type !== event) return\n        fn(data.value)\n      },\n      false,\n    )\n  }\n\n  listenToolbarIframeEvent(\"toolbar-visibility-change\", (visible) => {\n    if (visible) {\n      hideToolbarTrigger()\n    } else {\n      showToolbarTrigger()\n    }\n  })\n\n  const div = document.createElement(\"div\")\n  const jsenvLogoSvgSrc = new URL(\"./internal/toolbar/jsenv-logo.svg\", import.meta.url)\n  div.innerHTML = `\n<div id=\"jsenv-toolbar-trigger\">\n  <svg id=\"jsenv-toolbar-trigger-icon\">\n    <use xlink:href=\"${jsenvLogoSvgSrc}#jsenv-logo\"></use>\n  </svg>\n  <style>\n    #jsenv-toolbar-trigger {\n      display: block;\n      overflow: hidden;\n      position: fixed;\n      z-index: 1000;\n      bottom: -32px;\n      right: 20px;\n      height: 40px;\n      width: 40px;\n      padding: 0;\n      border-radius: 5px 5px 0 0;\n      border: 1px solid rgba(0, 0, 0, 0.33);\n      border-bottom: none;\n      box-shadow: 0px 0px 6px 2px rgba(0, 0, 0, 0.46);\n      background: transparent;\n      text-align: center;\n      transition: 600ms;\n    }\n\n    #jsenv-toolbar-trigger:hover {\n      cursor: pointer;\n    }\n\n    #jsenv-toolbar-trigger[data-expanded] {\n      bottom: 0;\n    }\n\n    #jsenv-toolbar-trigger-icon {\n      width: 35px;\n      height: 35px;\n      opacity: 0;\n      transition: 600ms;\n    }\n\n    #jsenv-toolbar-trigger[data-expanded] #jsenv-toolbar-trigger-icon {\n      opacity: 1;\n    }\n  </style>\n</div>`\n  const toolbarTrigger = div.firstElementChild\n  iframe.parentNode.appendChild(toolbarTrigger)\n\n  let timer\n  toolbarTrigger.onmouseenter = () => {\n    toolbarTrigger.setAttribute(\"data-animate\", \"\")\n    timer = setTimeout(expandToolbarTrigger, 500)\n  }\n  toolbarTrigger.onmouseleave = () => {\n    clearTimeout(timer)\n    collapseToolbarTrigger()\n  }\n  toolbarTrigger.onfocus = () => {\n    toolbarTrigger.removeAttribute(\"data-animate\")\n    expandToolbarTrigger()\n  }\n  toolbarTrigger.onblur = () => {\n    toolbarTrigger.removeAttribute(\"data-animate\")\n    clearTimeout(timer)\n    collapseToolbarTrigger()\n  }\n  toolbarTrigger.onclick = () => {\n    window.__jsenv__.toolbar.show()\n  }\n\n  const showToolbarTrigger = () => {\n    toolbarTrigger.style.display = \"block\"\n  }\n\n  const hideToolbarTrigger = () => {\n    toolbarTrigger.style.display = \"none\"\n  }\n\n  const expandToolbarTrigger = () => {\n    toolbarTrigger.setAttribute(\"data-expanded\", \"\")\n  }\n\n  const collapseToolbarTrigger = () => {\n    toolbarTrigger.removeAttribute(\"data-expanded\", \"\")\n  }\n  hideToolbarTrigger()\n\n  return iframe\n}\n\nconst getToolbarPlaceholder = () => {\n  const placeholder = queryPlaceholder()\n  if (placeholder) {\n    if (document.body.contains(placeholder)) {\n      return placeholder\n    }\n    // otherwise iframe would not be visible because in <head>\n    console.warn(\"element with [data-jsenv-toolbar-placeholder] must be inside document.body\")\n    return createTooolbarPlaceholder()\n  }\n  return createTooolbarPlaceholder()\n}\n\nconst queryPlaceholder = () => document.querySelector(\"[data-jsenv-toolbar-placeholder]\")\n\nconst createTooolbarPlaceholder = () => {\n  const placeholder = document.createElement(\"span\")\n  document.body.appendChild(placeholder)\n  return placeholder\n}\n\nconst iframeToLoadedPromise = (iframe) => {\n  return new Promise((resolve) => {\n    const onload = () => {\n      iframe.removeEventListener(\"load\", onload, true)\n      resolve()\n    }\n    iframe.addEventListener(\"load\", onload, true)\n  })\n}\n\nif (document.readyState === \"complete\") {\n  injectToolbar()\n} else {\n  window.addEventListener(\"load\", injectToolbar)\n}\n"
  ],
  "names": [
    "nativeTypeOf",
    "obj",
    "customTypeOf",
    "Symbol",
    "constructor",
    "prototype",
    "iterator",
    "getCurrentScriptSrc",
    "document",
    "currentScript",
    "src",
    "scripts",
    "Array",
    "slice",
    "call",
    "getElementsByTagName",
    "readyScript",
    "find",
    "script",
    "readyState",
    "Error",
    "err",
    "stackDetails",
    "exec",
    "stack",
    "scriptLocation",
    "line",
    "currentLocation",
    "location",
    "href",
    "replace",
    "hash",
    "source",
    "documentElement",
    "outerHTML",
    "codeRegExp",
    "RegExp",
    "code",
    "trim",
    "innerHTML",
    "url",
    "setStyles",
    "element",
    "styles",
    "elementStyle",
    "style",
    "restoreStyles",
    "Object",
    "keys",
    "map",
    "styleName",
    "restore",
    "currentStyle",
    "forEach",
    "setAttributes",
    "attributes",
    "name",
    "setAttribute",
    "_await",
    "value",
    "then",
    "direct",
    "Promise",
    "resolve",
    "connectLivereload",
    "window",
    "EventSource",
    "getLivereloadPreference",
    "localStorage",
    "hasOwnProperty",
    "JSON",
    "parse",
    "getItem",
    "isOpen",
    "lastEventId",
    "latestChangeMap",
    "events",
    "data",
    "reload",
    "eventSourceOrigin",
    "URL",
    "origin",
    "eventSource",
    "withCredentials",
    "disconnect",
    "close",
    "onopen",
    "onerror",
    "errorEvent",
    "target",
    "CLOSED",
    "eventName",
    "addEventListener",
    "e",
    "f",
    "args",
    "i",
    "arguments",
    "length",
    "apply",
    "reject",
    "__jsenv_eventsource__",
    "injectToolbar",
    "placeholder",
    "getToolbarPlaceholder",
    "iframe",
    "createElement",
    "tabindex",
    "allowtransparency",
    "position",
    "zIndex",
    "bottom",
    "left",
    "width",
    "height",
    "visibility",
    "border",
    "iframeLoadedPromise",
    "iframeToLoadedPromise",
    "parentNode",
    "replaceChild",
    "removeAttribute",
    "listenToolbarIframeEvent",
    "event",
    "fn",
    "messageEvent",
    "jsenv",
    "type",
    "visible",
    "hideToolbarTrigger",
    "showToolbarTrigger",
    "div",
    "jsenvLogoSvgSrc",
    "toolbarTrigger",
    "firstElementChild",
    "appendChild",
    "timer",
    "onmouseenter",
    "setTimeout",
    "expandToolbarTrigger",
    "onmouseleave",
    "clearTimeout",
    "collapseToolbarTrigger",
    "onfocus",
    "onblur",
    "onclick",
    "__jsenv__",
    "toolbar",
    "show",
    "display",
    "queryPlaceholder",
    "body",
    "contains",
    "console",
    "warn",
    "createTooolbarPlaceholder",
    "querySelector",
    "onload",
    "removeEventListener"
  ],
  "mappings": "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"
}