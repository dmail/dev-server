{
  "version": 3,
  "sources": [
    "../../../src/openBrowserServer/openBrowserServer.js"
  ],
  "names": [
    "getClientScript",
    "compileURL",
    "url",
    "fileRelativeToRoot",
    "pathname",
    "slice",
    "openBrowserServer",
    "root",
    "port",
    "forcePort",
    "rootLocation",
    "then",
    "server",
    "console",
    "log",
    "runServer",
    "addRequestHandler",
    "request",
    "body",
    "status",
    "headers",
    "Buffer",
    "byteLength",
    "script",
    "html"
  ],
  "mappings": ";;;;;;;AAAA;;AACA;;AACA;;AAEA,MAAMA,eAAe,GAAG,CAAC;AAAEC,EAAAA,UAAF;AAAcC,EAAAA;AAAd,CAAD,KAAyB;AAC/C,QAAMC,kBAAkB,GAAGD,GAAG,CAACE,QAAJ,CAAaC,KAAb,CAAmB,CAAnB,CAA3B;AAEA,SAAQ,yBAAwBJ,UAAW,IAAGE,kBAAmB,IAAjE;AACD,CAJD;;AAMO,MAAMG,iBAAiB,GAAG,CAAC;AAAEC,EAAAA,IAAF;AAAQC,EAAAA,IAAI,GAAG,IAAf;AAAqBC,EAAAA,SAAS,GAAG;AAAjC,CAAD,KAA6C;AAC5E,SAAO,0CAAkB;AACvBP,IAAAA,GAAG,EAAG,oBADiB;AAEvBQ,IAAAA,YAAY,EAAEH;AAFS,GAAlB,EAGJI,IAHI,CAGEC,MAAD,IAAY;AAClBC,IAAAA,OAAO,CAACC,GAAR,CAAa,aAAYP,IAAK,OAAMK,MAAM,CAACV,GAAI,EAA/C;AACA,WAAO,4BAAW;AAAEA,MAAAA,GAAG,EAAG,oBAAmBM,IAAK,EAAhC;AAAmCC,MAAAA;AAAnC,KAAX,EAA2DE,IAA3D,CAAiEI,SAAD,IAAe;AACpFA,MAAAA,SAAS,CAACC,iBAAV,CAA6BC,OAAD,IAAa;AACvC,YAAIA,OAAO,CAACf,GAAR,CAAYE,QAAZ,KAAyB,GAA7B,EAAkC;AAChC,gBAAMc,IAAI,GAAI;;;eAGTX,IAAK;;;;;;wCAMoBA,IAAK;;;;;aATnC;AAgBA,iBAAO;AACLY,YAAAA,MAAM,EAAE,GADH;AAELC,YAAAA,OAAO,EAAE;AACP,8BAAgB,WADT;AAEP,gCAAkBC,MAAM,CAACC,UAAP,CAAkBJ,IAAlB,CAFX;AAGP,+BAAiB;AAHV,aAFJ;AAOLA,YAAAA;AAPK,WAAP;AASD;;AAED,eAAO,gDAAqB;AAC1BK,UAAAA,MAAM,EAAEvB,eAAe,CAAC;AAAEC,YAAAA,UAAU,EAAEW,MAAM,CAACX,UAArB;AAAiCC,YAAAA,GAAG,EAAEe,OAAO,CAACf;AAA9C,WAAD;AADG,SAArB,EAEJS,IAFI,CAEEa,IAAD,IAAU;AAChB,iBAAO;AACLL,YAAAA,MAAM,EAAE,GADH;AAELC,YAAAA,OAAO,EAAE;AACP,8BAAgB,WADT;AAEP,gCAAkBC,MAAM,CAACC,UAAP,CAAkBE,IAAlB,CAFX;AAGP,+BAAiB;AAHV,aAFJ;AAOLN,YAAAA,IAAI,EAAEM;AAPD,WAAP;AASD,SAZM,CAAP;AAaD,OA1CD;AA4CAX,MAAAA,OAAO,CAACC,GAAR,CAAa,aAAYP,IAAK,OAAMQ,SAAS,CAACb,GAAI,EAAlD;AAEA,aAAOa,SAAP;AACD,KAhDM,CAAP;AAiDD,GAtDM,CAAP;AAuDD,CAxDM",
  "sourcesContent": [
    "import { openCompileServer } from \"../openCompileServer/openCompileServer.js\"\nimport { openServer } from \"../openServer/openServer.js\"\nimport { createHTMLForBrowser } from \"../createHTMLForBrowser.js\"\n\nconst getClientScript = ({ compileURL, url }) => {\n  const fileRelativeToRoot = url.pathname.slice(1)\n\n  return `window.System.import(\"${compileURL}/${fileRelativeToRoot}\")`\n}\n\nexport const openBrowserServer = ({ root, port = 3000, forcePort = true }) => {\n  return openCompileServer({\n    url: `http://127.0.0.1:0`,\n    rootLocation: root,\n  }).then((server) => {\n    console.log(`compiling ${root} at ${server.url}`)\n    return openServer({ url: `http://127.0.0.1:${port}`, forcePort }).then((runServer) => {\n      runServer.addRequestHandler((request) => {\n        if (request.url.pathname === \"/\") {\n          const body = `<!doctype html>\n\n\t\t\t\t\t<head>\n\t\t\t\t\t\t<title>${root}</title>\n\t\t\t\t\t\t<meta charset=\"utf-8\" />\n\t\t\t\t\t</head>\n\n\t\t\t\t\t<body>\n\t\t\t\t\t\t<main>\n\t\t\t\t\t\t\tThis is the root your project: ${root} <br />\n\t\t\t\t\t\t\tYou can execute file by navigating like <a href=\"./src/__test__/file.js\">src/__test__/file.js</a>\n\t\t\t\t\t\t</main>\n\t\t\t\t\t</body>\n\n\t\t\t\t\t</html>`\n\n          return {\n            status: 200,\n            headers: {\n              \"content-type\": \"text/html\",\n              \"content-length\": Buffer.byteLength(body),\n              \"cache-control\": \"no-store\",\n            },\n            body,\n          }\n        }\n\n        return createHTMLForBrowser({\n          script: getClientScript({ compileURL: server.compileURL, url: request.url }),\n        }).then((html) => {\n          return {\n            status: 200,\n            headers: {\n              \"content-type\": \"text/html\",\n              \"content-length\": Buffer.byteLength(html),\n              \"cache-control\": \"no-store\",\n            },\n            body: html,\n          }\n        })\n      })\n\n      console.log(`executing ${root} at ${runServer.url}`)\n\n      return runServer\n    })\n  })\n}\n"
  ]
}