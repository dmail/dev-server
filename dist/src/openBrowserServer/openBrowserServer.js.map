{
  "version": 3,
  "sources": [
    "../../../src/openBrowserServer/openBrowserServer.js"
  ],
  "names": [
    "getClientScript",
    "compileURL",
    "url",
    "fileRelativeToRoot",
    "pathname",
    "slice",
    "openBrowserServer",
    "root",
    "port",
    "rootLocation",
    "then",
    "server",
    "console",
    "log",
    "runServer",
    "addRequestHandler",
    "request",
    "script",
    "html",
    "status",
    "headers",
    "Buffer",
    "byteLength",
    "body"
  ],
  "mappings": ";;;;;;;AAAA;;AACA;;AACA;;AAEA,MAAMA,eAAe,GAAG,CAAC;AAAEC,EAAAA,UAAF;AAAcC,EAAAA;AAAd,CAAD,KAAyB;AAC/C,QAAMC,kBAAkB,GAAGD,GAAG,CAACE,QAAJ,CAAaC,KAAb,CAAmB,CAAnB,CAA3B;AAEA,SAAQ,yBAAwBJ,UAAW,IAAGE,kBAAmB,IAAjE;AACD,CAJD;;AAMO,MAAMG,iBAAiB,GAAG,CAAC;AAAEC,EAAAA,IAAF;AAAQC,EAAAA,IAAI,GAAG;AAAf,CAAD,KAAwB;AACvD,SAAO,0CAAkB;AACvBN,IAAAA,GAAG,EAAG,oBADiB;AAEvBO,IAAAA,YAAY,EAAEF;AAFS,GAAlB,EAGJG,IAHI,CAGEC,MAAD,IAAY;AAClBC,IAAAA,OAAO,CAACC,GAAR,CAAa,aAAYN,IAAK,OAAMI,MAAM,CAACT,GAAI,EAA/C;AACA,WAAO,4BAAW;AAAEA,MAAAA,GAAG,EAAG,oBAAmBM,IAAK;AAAhC,KAAX,EAAgDE,IAAhD,CAAsDI,SAAD,IAAe;AACzEA,MAAAA,SAAS,CAACC,iBAAV,CAA6BC,OAAD,IAAa;AACvC,YAAIA,OAAO,CAACd,GAAR,CAAYE,QAAZ,KAAyB,GAA7B,EAAkC,CAChC;AACA;AACD;;AAED,eAAO,gDAAqB;AAC1Ba,UAAAA,MAAM,EAAEjB,eAAe,CAAC;AAAEC,YAAAA,UAAU,EAAEU,MAAM,CAACV,UAArB;AAAiCC,YAAAA,GAAG,EAAEc,OAAO,CAACd;AAA9C,WAAD;AADG,SAArB,EAEJQ,IAFI,CAEEQ,IAAD,IAAU;AAChB,iBAAO;AACLC,YAAAA,MAAM,EAAE,GADH;AAELC,YAAAA,OAAO,EAAE;AACP,8BAAgB,WADT;AAEP,gCAAkBC,MAAM,CAACC,UAAP,CAAkBJ,IAAlB,CAFX;AAGP,+BAAiB;AAHV,aAFJ;AAOLK,YAAAA,IAAI,EAAEL;AAPD,WAAP;AASD,SAZM,CAAP;AAaD,OAnBD;AAqBAN,MAAAA,OAAO,CAACC,GAAR,CAAa,aAAYN,IAAK,OAAMO,SAAS,CAACZ,GAAI,EAAlD;AAEA,aAAOY,SAAP;AACD,KAzBM,CAAP;AA0BD,GA/BM,CAAP;AAgCD,CAjCM",
  "sourcesContent": [
    "import { openCompileServer } from \"../openCompileServer/openCompileServer.js\"\nimport { openServer } from \"../openServer/openServer.js\"\nimport { createHTMLForBrowser } from \"../createHTMLForBrowser.js\"\n\nconst getClientScript = ({ compileURL, url }) => {\n  const fileRelativeToRoot = url.pathname.slice(1)\n\n  return `window.System.import(\"${compileURL}/${fileRelativeToRoot}\")`\n}\n\nexport const openBrowserServer = ({ root, port = 0 }) => {\n  return openCompileServer({\n    url: `http://127.0.0.1:0`,\n    rootLocation: root,\n  }).then((server) => {\n    console.log(`compiling ${root} at ${server.url}`)\n    return openServer({ url: `http://127.0.0.1:${port}` }).then((runServer) => {\n      runServer.addRequestHandler((request) => {\n        if (request.url.pathname === \"/\") {\n          // on voudrait ptet servir du html\n          // pour expliquer comment run les fichier etc\n        }\n\n        return createHTMLForBrowser({\n          script: getClientScript({ compileURL: server.compileURL, url: request.url }),\n        }).then((html) => {\n          return {\n            status: 200,\n            headers: {\n              \"content-type\": \"text/html\",\n              \"content-length\": Buffer.byteLength(html),\n              \"cache-control\": \"no-store\",\n            },\n            body: html,\n          }\n        })\n      })\n\n      console.log(`executing ${root} at ${runServer.url}`)\n\n      return runServer\n    })\n  })\n}\n"
  ]
}