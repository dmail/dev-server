{
  "version": 3,
  "sources": [
    "../../../src/openFirefoxClient/openFirefoxClient.js"
  ],
  "names": [
    "clientFunction",
    "file",
    "setupSource",
    "teardownSource",
    "done",
    "eval",
    "window",
    "System",
    "import",
    "then",
    "value",
    "status",
    "openFirefoxClient",
    "compileURL",
    "headless",
    "runFile",
    "driver",
    "setup",
    "teardown",
    "executeScriptAsync",
    "toString",
    "Promise",
    "reject",
    "options",
    "firefox",
    "Options",
    "Builder",
    "forBrowser",
    "setFirefoxOptions",
    "build",
    "title",
    "indexHTML",
    "indexBody",
    "indexRequestHandler",
    "execute",
    "autoClean",
    "collectCoverage",
    "remoteFile",
    "get",
    "url",
    "stop",
    "close",
    "quit"
  ],
  "mappings": "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",
  "sourcesContent": [
    "// https://www.npmjs.com/package/selenium-webdriver\n\n// http://seleniumhq.github.io/selenium/docs/api/javascript/module/selenium-webdriver/index_exports_WebDriver.html\nimport { Builder } from \"selenium-webdriver\"\n// https://github.com/SeleniumHQ/selenium/blob/master/javascript/node/selenium-webdriver/firefox.js#L34\nimport firefox from \"selenium-webdriver/firefox\"\nimport { createHTMLForBrowser } from \"../createHTMLForBrowser.js\"\nimport { openIndexServer } from \"../openIndexServer/openIndexServer.js\"\nimport { getRemoteLocation } from \"../getRemoteLocation.js\"\nimport { getBrowserSetupAndTeardowm } from \"../getClientSetupAndTeardown.js\"\n\nconst clientFunction = (file, setupSource, teardownSource, done) => {\n  eval(setupSource)(file)\n  window.System.import(file)\n    .then(eval(teardownSource))\n    .then(\n      (value) => done({ status: \"resolved\", value }),\n      (value) => done({ status: \"rejected\", value }),\n    )\n}\n\nexport const openFirefoxClient = ({\n  compileURL,\n  headless = true,\n  runFile = ({ driver, file, setup, teardown }) => {\n    return driver\n      .executeScriptAsync(\n        `(${clientFunction.toString()}.apply(this, arguments)`,\n        file,\n        `(${setup.toString()})`,\n        `(${teardown.toString()})`,\n      )\n      .then(({ status, value }) => {\n        return status === \"resolved\" ? value : Promise.reject(value)\n      })\n  },\n}) => {\n  const options = new firefox.Options()\n  if (headless) {\n    options.headless()\n  }\n\n  return new Builder()\n    .forBrowser(\"firefox\")\n    .setFirefoxOptions(options)\n    .build()\n    .then((driver) => {\n      return createHTMLForBrowser({\n        title: \"Skeleton for Firefox\",\n      }).then((indexHTML) => {\n        return openIndexServer({\n          indexBody: indexHTML,\n        }).then((indexRequestHandler) => {\n          const execute = ({ file, autoClean = false, collectCoverage = false }) => {\n            const remoteFile = getRemoteLocation({\n              compileURL,\n\n              file,\n            })\n\n            return driver\n              .get(indexRequestHandler.url)\n              .then(() =>\n                runFile({\n                  driver,\n                  file: remoteFile,\n                  ...getBrowserSetupAndTeardowm({ collectCoverage }),\n                }),\n              )\n              .then(({ status, value }) => {\n                if (autoClean) {\n                  indexRequestHandler.stop()\n                }\n\n                if (status === \"resolved\") {\n                  return value\n                }\n                return Promise.reject(value)\n              })\n          }\n\n          const close = () => {\n            return driver.quit()\n          }\n\n          return { execute, close }\n        })\n      })\n    })\n}\n"
  ]
}