{
  "version": 3,
  "sources": [
    "../../../src/openFirefoxClient/openFirefoxClient.js"
  ],
  "names": [
    "clientFunction",
    "file",
    "setupSource",
    "teardownSource",
    "done",
    "eval",
    "window",
    "System",
    "import",
    "then",
    "value",
    "status",
    "openFirefoxClient",
    "compileURL",
    "headless",
    "runFile",
    "driver",
    "setup",
    "teardown",
    "executeScriptAsync",
    "toString",
    "Promise",
    "reject",
    "options",
    "firefox",
    "Options",
    "Builder",
    "forBrowser",
    "setFirefoxOptions",
    "build",
    "title",
    "indexHTML",
    "indexBody",
    "indexRequestHandler",
    "execute",
    "autoClean",
    "collectCoverage",
    "remoteFile",
    "get",
    "url",
    "stop",
    "close",
    "quit"
  ],
  "mappings": "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",
  "sourcesContent": [
    "// https://www.npmjs.com/package/selenium-webdriver\n\n// http://seleniumhq.github.io/selenium/docs/api/javascript/module/selenium-webdriver/index_exports_WebDriver.html\nimport { Builder } from \"selenium-webdriver\"\n// https://github.com/SeleniumHQ/selenium/blob/master/javascript/node/selenium-webdriver/firefox.js#L34\nimport firefox from \"selenium-webdriver/firefox\"\nimport { createHTMLForBrowser } from \"../createHTMLForBrowser.js\"\nimport { openIndexServer } from \"../openIndexServer/openIndexServer.js\"\nimport { getRemoteLocation } from \"../getRemoteLocation.js\"\nimport { getBrowserSetupAndTeardowm } from \"../getClientSetupAndTeardown.js\"\n\nconst clientFunction = (file, setupSource, teardownSource, done) => {\n  eval(setupSource)(file)\n  window.System.import(file)\n    .then(eval(teardownSource))\n    .then(\n      (value) => done({ status: \"resolved\", value }),\n      (value) => done({ status: \"rejected\", value }),\n    )\n}\n\nexport const openFirefoxClient = ({\n  compileURL,\n  headless = true,\n  runFile = ({ driver, file, setup, teardown }) => {\n    return driver\n      .executeScriptAsync(\n        `(${clientFunction.toString()}.apply(this, arguments)`,\n        file,\n        `(${setup.toString()})`,\n        `(${teardown.toString()})`,\n      )\n      .then(({ status, value }) => {\n        return status === \"resolved\" ? value : Promise.reject(value)\n      })\n  },\n}) => {\n  const options = new firefox.Options()\n  if (headless) {\n    options.headless()\n  }\n\n  return new Builder()\n    .forBrowser(\"firefox\")\n    .setFirefoxOptions(options)\n    .build()\n    .then((driver) => {\n      return createHTMLForBrowser({\n        title: \"Skeleton for Firefox\",\n      }).then((indexHTML) => {\n        return openIndexServer({\n          indexBody: indexHTML,\n        }).then((indexRequestHandler) => {\n          const execute = ({ file, autoClean = false, collectCoverage = false }) => {\n            const remoteFile = getRemoteLocation({\n              compileURL,\n\n              file,\n            })\n\n            return driver\n              .get(indexRequestHandler.url)\n              .then(() =>\n                runFile({\n                  driver,\n                  file: remoteFile,\n                  ...getBrowserSetupAndTeardowm({ collectCoverage }),\n                }),\n              )\n              .then(({ status, value }) => {\n                if (autoClean) {\n                  indexRequestHandler.stop()\n                }\n\n                if (status === \"resolved\") {\n                  return value\n                }\n                return Promise.reject(value)\n              })\n          }\n\n          const close = () => {\n            return driver.quit()\n          }\n\n          return { execute, close }\n        })\n      })\n    })\n}\n"
  ]
}