{
  "version": 3,
  "sources": [
    "../../../src/openServer/createNodeRequestHandler.test.js"
  ],
  "names": [
    "then",
    "addRequestHandler",
    "url",
    "agent",
    "close",
    "nodeRequestHandler",
    "handler",
    "status",
    "headers",
    "body",
    "response",
    "text",
    "assert",
    "equal"
  ],
  "mappings": ";;AAAA;;AACA;;AACA;;AACA;;AACA;;;;AAEA,gBAAK,MAAM;AACT,SAAO,8BAAaA,IAAb,CAAkB,CAAC;AAAEC,IAAAA,iBAAF;AAAqBC,IAAAA,GAArB;AAA0BC,IAAAA,KAA1B;AAAiCC,IAAAA;AAAjC,GAAD,KAA8C;AACrE,UAAMC,kBAAkB,GAAG,wDAAyB;AAClDC,MAAAA,OAAO,EAAE,MAAM;AACb;AACA;AACA;AACA,eAAO;AACLC,UAAAA,MAAM,EAAE,GADH;AAELC,UAAAA,OAAO,EAAE;AACP,8BAAkB;AADX,WAFJ;AAKLC,UAAAA,IAAI,EAAE;AALD,SAAP;AAOD,OAZiD;AAalDP,MAAAA;AAbkD,KAAzB,CAA3B;AAgBAD,IAAAA,iBAAiB,CAACI,kBAAD,CAAjB;AAEA,WAAO,wBAAMH,GAAN,EAAW;AAAEC,MAAAA;AAAF,KAAX,EACJH,IADI,CACEU,QAAD,IAAcA,QAAQ,CAACC,IAAT,EADf,EAEJX,IAFI,CAEEW,IAAD,IAAU;AACdC,sBAAOC,KAAP,CAAaF,IAAb,EAAmB,IAAnB;;AACA,aAAOP,KAAK,EAAZ;AACD,KALI,CAAP;AAMD,GAzBM,CAAP;AA0BD,CA3BD",
  "sourcesContent": [
    "import { test } from \"@dmail/test\"\nimport assert from \"assert\"\nimport fetch from \"node-fetch\"\nimport { createNodeRequestHandler } from \"./createNodeRequestHandler.js\"\nimport { openServer } from \"./openServer.js\"\n\ntest(() => {\n  return openServer().then(({ addRequestHandler, url, agent, close }) => {\n    const nodeRequestHandler = createNodeRequestHandler({\n      handler: () => {\n        // as we can see the whole concept behind createNodeRequestHandler\n        // is to avoid using response methods directly but rather\n        // return POJO that takes care of using response methods\n        return {\n          status: 200,\n          headers: {\n            \"content-length\": 2,\n          },\n          body: \"ok\",\n        }\n      },\n      url,\n    })\n\n    addRequestHandler(nodeRequestHandler)\n\n    return fetch(url, { agent })\n      .then((response) => response.text())\n      .then((text) => {\n        assert.equal(text, \"ok\")\n        return close()\n      })\n  })\n})\n"
  ]
}