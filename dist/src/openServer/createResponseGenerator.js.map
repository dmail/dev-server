{"version":3,"sources":["../../../src/openServer/createResponseGenerator.js"],"names":["createResponseGenerator","services","generateResponse","args","Promise","resolve","reject","visit","index","length","service","then","value","status","reason"],"mappings":";;;;;AAAA;;AAEO,IAAMA,4DAA0B,SAA1BA,uBAA0B,OAAuB;AAAA,2BAApBC,QAAoB;AAAA,MAApBA,QAAoB,iCAAT,EAAS;;AAC5D,MAAMC,mBAAmB,SAAnBA,gBAAmB,GAAa;AAAA,sCAATC,IAAS;AAATA,UAAS;AAAA;;AACpC,WAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,UAAMC,QAAQ,SAARA,KAAQ,CAACC,KAAD,EAAW;AACvB,YAAIA,SAASP,SAASQ,MAAtB,EAA8B;AAC5B,iBAAOJ,SAAP;AACD;;AAED,YAAMK,UAAUT,SAASO,KAAT,CAAhB;AACAJ,gBAAQC,OAAR,CAAgBK,yBAAWP,IAAX,CAAhB,EAAkCQ,IAAlC,CACE,UAACC,KAAD,EAAW;AACT,cAAIA,KAAJ,EAAW;AACTP,oBAAQO,KAAR;AACD,WAFD,MAEO;AACLL,kBAAMC,QAAQ,CAAd;AACD;AACF,SAPH,EAQE,UAACI,KAAD,EAAW;AACT,cAAIA,KAAJ,EAAW;AACTN,mBAAOM,KAAP;AACD,WAFD,MAEO;AACLL,kBAAMC,QAAQ,CAAd;AACD;AACF,SAdH;AAgBD,OAtBD;;AAwBAD,YAAM,CAAN;AACD,KA1BM,EA0BJI,IA1BI,CA0BC,UAACC,KAAD,EAAW;AACjB,UAAIA,KAAJ,EAAW;AACT,eAAOA,KAAP;AACD;AACD,aAAO,EAAEC,QAAQ,GAAV,EAAeC,QAAQ,gBAAvB,EAAP;AACD,KA/BM,CAAP;AAgCD,GAjCD;;AAmCA,SAAOZ,gBAAP;AACD,CArCM","file":"createResponseGenerator.js","sourcesContent":["// https://github.com/jsenv/core/blob/master/src/util/rest/helpers.js\n\nexport const createResponseGenerator = ({ services = [] }) => {\n  const generateResponse = (...args) => {\n    return new Promise((resolve, reject) => {\n      const visit = (index) => {\n        if (index >= services.length) {\n          return resolve()\n        }\n\n        const service = services[index]\n        Promise.resolve(service(...args)).then(\n          (value) => {\n            if (value) {\n              resolve(value)\n            } else {\n              visit(index + 1)\n            }\n          },\n          (value) => {\n            if (value) {\n              reject(value)\n            } else {\n              visit(index + 1)\n            }\n          },\n        )\n      }\n\n      visit(0)\n    }).then((value) => {\n      if (value) {\n        return value\n      }\n      return { status: 501, reason: \"no implemented\" }\n    })\n  }\n\n  return generateResponse\n}\n"]}