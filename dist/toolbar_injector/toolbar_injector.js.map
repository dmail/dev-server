{
  "version": 3,
  "file": "toolbar_injector.js",
  "sources": [
    "../../src/internal/browser_utils/fetch_using_xhr.js",
    "../../src/internal/browser_utils/fetch_browser.js",
    "../../src/internal/browser_utils/fetch_json.js",
    "../../src/internal/dev_server/exploring/fetch_exploring_json.js",
    "../../src/internal/dev_server/toolbar/util/dom.js",
    "../../src/internal/dev_server/toolbar/toolbar_injector.js"
  ],
  "sourcesContent": [
    "export const fetchUsingXHR = async (\n  url,\n  {\n    signal,\n    method = \"GET\",\n    credentials = \"same-origin\",\n    headers = {},\n    body = null,\n  } = {},\n) => {\n  const headersPromise = createPromiseAndHooks()\n  const bodyPromise = createPromiseAndHooks()\n\n  const xhr = new XMLHttpRequest()\n\n  const failure = (error) => {\n    // if it was already resolved, we must reject the body promise\n    if (headersPromise.settled) {\n      bodyPromise.reject(error)\n    } else {\n      headersPromise.reject(error)\n    }\n  }\n\n  const cleanup = () => {\n    xhr.ontimeout = null\n    xhr.onerror = null\n    xhr.onload = null\n    xhr.onreadystatechange = null\n  }\n\n  xhr.ontimeout = () => {\n    cleanup()\n    failure(new Error(`xhr request timeout on ${url}.`))\n  }\n\n  xhr.onerror = (error) => {\n    cleanup()\n    // unfortunately with have no clue why it fails\n    // might be cors for instance\n    failure(createRequestError(error, { url }))\n  }\n\n  xhr.onload = () => {\n    cleanup()\n    bodyPromise.resolve()\n  }\n\n  signal.addEventListener(\"abort\", () => {\n    xhr.abort()\n    const abortError = new Error(\"aborted\")\n    abortError.name = \"AbortError\"\n    failure(abortError)\n  })\n\n  xhr.onreadystatechange = () => {\n    // https://developer.mozilla.org/fr/docs/Web/API/XMLHttpRequest/readyState\n    const { readyState } = xhr\n\n    if (readyState === 2) {\n      headersPromise.resolve()\n    } else if (readyState === 4) {\n      cleanup()\n      bodyPromise.resolve()\n    }\n  }\n\n  xhr.open(method, url, true)\n  Object.keys(headers).forEach((key) => {\n    xhr.setRequestHeader(key, headers[key])\n  })\n  xhr.withCredentials = computeWithCredentials({ credentials, url })\n  if (\"responseType\" in xhr && hasBlob) {\n    xhr.responseType = \"blob\"\n  }\n  xhr.send(body)\n\n  await headersPromise\n\n  // https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseURL\n  const responseUrl =\n    \"responseURL\" in xhr ? xhr.responseURL : headers[\"x-request-url\"]\n  let responseStatus = xhr.status\n  const responseStatusText = xhr.statusText\n  const responseHeaders = getHeadersFromXHR(xhr)\n\n  const readBody = async () => {\n    await bodyPromise\n\n    const { status } = xhr\n    // in Chrome on file:/// URLs, status is 0\n    if (status === 0) {\n      responseStatus = 200\n    }\n\n    const body = \"response\" in xhr ? xhr.response : xhr.responseText\n\n    return {\n      responseBody: body,\n      responseBodyType: detectBodyType(body),\n    }\n  }\n\n  const text = async () => {\n    const { responseBody, responseBodyType } = await readBody()\n\n    if (responseBodyType === \"blob\") {\n      return blobToText(responseBody)\n    }\n    if (responseBodyType === \"formData\") {\n      throw new Error(\"could not read FormData body as text\")\n    }\n    if (responseBodyType === \"dataView\") {\n      return arrayBufferToText(responseBody.buffer)\n    }\n    if (responseBodyType === \"arrayBuffer\") {\n      return arrayBufferToText(responseBody)\n    }\n    // if (responseBodyType === \"text\" || responseBodyType === 'searchParams') {\n    //   return body\n    // }\n    return String(responseBody)\n  }\n\n  const json = async () => {\n    const responseText = await text()\n    return JSON.parse(responseText)\n  }\n\n  const blob = async () => {\n    if (!hasBlob) {\n      throw new Error(`blob not supported`)\n    }\n\n    const { responseBody, responseBodyType } = await readBody()\n\n    if (responseBodyType === \"blob\") {\n      return responseBody\n    }\n    if (responseBodyType === \"dataView\") {\n      return new Blob([cloneBuffer(responseBody.buffer)])\n    }\n    if (responseBodyType === \"arrayBuffer\") {\n      return new Blob([cloneBuffer(responseBody)])\n    }\n    if (responseBodyType === \"formData\") {\n      throw new Error(\"could not read FormData body as blob\")\n    }\n    return new Blob([String(responseBody)])\n  }\n\n  const arrayBuffer = async () => {\n    const { responseBody, responseBodyType } = await readBody()\n\n    if (responseBodyType === \"arrayBuffer\") {\n      return cloneBuffer(responseBody)\n    }\n    const responseBlob = await blob()\n    return blobToArrayBuffer(responseBlob)\n  }\n\n  const formData = async () => {\n    if (!hasFormData) {\n      throw new Error(`formData not supported`)\n    }\n    const responseText = await text()\n    return textToFormData(responseText)\n  }\n\n  return {\n    url: responseUrl,\n    status: responseStatus,\n    statusText: responseStatusText,\n    headers: responseHeaders,\n    text,\n    json,\n    blob,\n    arrayBuffer,\n    formData,\n  }\n}\n\nconst canUseBlob = () => {\n  if (typeof window.FileReader !== \"function\") return false\n\n  if (typeof window.Blob !== \"function\") return false\n\n  try {\n    // eslint-disable-next-line no-new\n    new Blob()\n    return true\n  } catch (e) {\n    return false\n  }\n}\n\nconst hasBlob = canUseBlob()\n\nconst hasFormData = typeof window.FormData === \"function\"\n\nconst hasArrayBuffer = typeof window.ArrayBuffer === \"function\"\n\nconst hasSearchParams = typeof window.URLSearchParams === \"function\"\n\nconst createRequestError = (error, { url }) => {\n  return new Error(\n    `error during xhr request on ${url}.\n--- error stack ---\n${error.stack}`,\n  )\n}\n\nconst createPromiseAndHooks = () => {\n  let resolve\n  let reject\n  const promise = new Promise((res, rej) => {\n    resolve = (value) => {\n      promise.settled = true\n      res(value)\n    }\n    reject = (value) => {\n      promise.settled = true\n      rej(value)\n    }\n  })\n  promise.resolve = resolve\n  promise.reject = reject\n  return promise\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch\nconst computeWithCredentials = ({ credentials, url }) => {\n  if (credentials === \"same-origin\") {\n    return originSameAsGlobalOrigin(url)\n  }\n  return credentials === \"include\"\n}\n\nconst originSameAsGlobalOrigin = (url) => {\n  // if we cannot read globalOrigin from window.location.origin, let's consider it's ok\n  if (typeof window !== \"object\") return true\n  if (typeof window.location !== \"object\") return true\n  const globalOrigin = window.location.origin\n  if (globalOrigin === \"null\") return true\n  return hrefToOrigin(url) === globalOrigin\n}\n\nconst detectBodyType = (body) => {\n  if (!body) {\n    return \"\"\n  }\n  if (typeof body === \"string\") {\n    return \"text\"\n  }\n  if (hasBlob && Blob.prototype.isPrototypeOf(body)) {\n    return \"blob\"\n  }\n  if (hasFormData && FormData.prototype.isPrototypeOf(body)) {\n    return \"formData\"\n  }\n  if (hasArrayBuffer) {\n    if (hasBlob && isDataView(body)) {\n      return `dataView`\n    }\n    if (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body)) {\n      return `arrayBuffer`\n    }\n  }\n  if (hasSearchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n    return \"searchParams\"\n  }\n  return \"\"\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/getAllResponseHeaders#Example\nconst getHeadersFromXHR = (xhr) => {\n  const headerMap = {}\n\n  const headersString = xhr.getAllResponseHeaders()\n  if (headersString === \"\") return headerMap\n\n  const lines = headersString.trim().split(/[\\r\\n]+/)\n  lines.forEach((line) => {\n    const parts = line.split(\": \")\n    const name = parts.shift()\n    const value = parts.join(\": \")\n    headerMap[name.toLowerCase()] = value\n  })\n\n  return headerMap\n}\n\nconst hrefToOrigin = (href) => {\n  const scheme = hrefToScheme(href)\n\n  if (scheme === \"file\") {\n    return \"file://\"\n  }\n\n  if (scheme === \"http\" || scheme === \"https\") {\n    const secondProtocolSlashIndex = scheme.length + \"://\".length\n    const pathnameSlashIndex = href.indexOf(\"/\", secondProtocolSlashIndex)\n\n    if (pathnameSlashIndex === -1) return href\n    return href.slice(0, pathnameSlashIndex)\n  }\n\n  return href.slice(0, scheme.length + 1)\n}\n\nconst hrefToScheme = (href) => {\n  const colonIndex = href.indexOf(\":\")\n  if (colonIndex === -1) return \"\"\n  return href.slice(0, colonIndex)\n}\n\nconst isDataView = (obj) => {\n  return obj && DataView.prototype.isPrototypeOf(obj)\n}\n\nconst isArrayBufferView =\n  ArrayBuffer.isView ||\n  (() => {\n    const viewClasses = [\n      \"[object Int8Array]\",\n      \"[object Uint8Array]\",\n      \"[object Uint8ClampedArray]\",\n      \"[object Int16Array]\",\n      \"[object Uint16Array]\",\n      \"[object Int32Array]\",\n      \"[object Uint32Array]\",\n      \"[object Float32Array]\",\n      \"[object Float64Array]\",\n    ]\n\n    return (value) => {\n      return (\n        value && viewClasses.includes(Object.prototype.toString.call(value))\n      )\n    }\n  })()\n\nconst textToFormData = (text) => {\n  const form = new FormData()\n  text\n    .trim()\n    .split(\"&\")\n    .forEach(function (bytes) {\n      if (bytes) {\n        const split = bytes.split(\"=\")\n        const name = split.shift().replace(/\\+/g, \" \")\n        const value = split.join(\"=\").replace(/\\+/g, \" \")\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\n      }\n    })\n  return form\n}\n\nconst blobToArrayBuffer = async (blob) => {\n  const reader = new FileReader()\n  const promise = fileReaderReady(reader)\n  reader.readAsArrayBuffer(blob)\n  return promise\n}\n\nconst blobToText = (blob) => {\n  const reader = new FileReader()\n  const promise = fileReaderReady(reader)\n  reader.readAsText(blob)\n  return promise\n}\n\nconst arrayBufferToText = (arrayBuffer) => {\n  const view = new Uint8Array(arrayBuffer)\n  const chars = new Array(view.length)\n  let i = 0\n  while (i < view.length) {\n    chars[i] = String.fromCharCode(view[i])\n\n    i++\n  }\n  return chars.join(\"\")\n}\n\nconst fileReaderReady = (reader) => {\n  return new Promise(function (resolve, reject) {\n    reader.onload = function () {\n      resolve(reader.result)\n    }\n    reader.onerror = function () {\n      reject(reader.error)\n    }\n  })\n}\n\nconst cloneBuffer = (buffer) => {\n  if (buffer.slice) {\n    return buffer.slice(0)\n  }\n  const view = new Uint8Array(buffer.byteLength)\n  view.set(new Uint8Array(buffer))\n  return view.buffer\n}\n",
    "import { fetchUsingXHR } from \"./fetch_using_xhr.js\"\n\nconst fetchNative = async (url, { mode = \"cors\", ...options } = {}) => {\n  const response = await window.fetch(url, {\n    mode,\n    ...options,\n  })\n\n  return {\n    url: response.url,\n    status: response.status,\n    statusText: \"\",\n    headers: responseToHeaders(response),\n    text: () => response.text(),\n    json: () => response.json(),\n    blob: () => response.blob(),\n    arrayBuffer: () => response.arrayBuffer(),\n    formData: () => response.formData(),\n  }\n}\n\nconst responseToHeaders = (response) => {\n  const headers = {}\n  response.headers.forEach((value, name) => {\n    headers[name] = value\n  })\n  return headers\n}\n\nexport const fetchUrl =\n  typeof window.fetch === \"function\" &&\n  typeof window.AbortController === \"function\"\n    ? fetchNative\n    : fetchUsingXHR\n",
    "import { fetchUrl } from \"./fetch_browser.js\"\n\nexport const fetchJson = async (url, options = {}) => {\n  const response = await fetchUrl(url, options)\n  const object = await response.json()\n  return object\n}\n",
    "import { fetchJson } from \"../../browser_utils/fetch_json.js\"\n\nexport const fetchExploringJson = async ({ signal } = {}) => {\n  try {\n    const exploringInfo = await fetchJson(\"/.jsenv/exploring.json\", {\n      signal,\n    })\n    return exploringInfo\n  } catch (e) {\n    if (signal && signal.aborted && e.name === \"AbortError\") {\n      throw e\n    }\n    throw new Error(\n      `Cannot communicate with exploring server due to a network error\n--- error stack ---\n${e.stack}`,\n    )\n  }\n}\n",
    "export const updateIframeOverflowOnParentWindow = () => {\n  if (!window.parent) {\n    // can happen while parent iframe reloads\n    return\n  }\n\n  const aTooltipIsOpened =\n    document.querySelector(\"[data-tooltip-visible]\") ||\n    document.querySelector(\"[data-tooltip-auto-visible]\")\n  const settingsAreOpened = document.querySelector(\"#settings[data-active]\")\n\n  if (aTooltipIsOpened || settingsAreOpened) {\n    enableIframeOverflowOnParentWindow()\n  } else {\n    disableIframeOverflowOnParentWindow()\n  }\n}\n\nlet iframeOverflowEnabled = false\nconst enableIframeOverflowOnParentWindow = () => {\n  if (iframeOverflowEnabled) return\n  iframeOverflowEnabled = true\n\n  const iframe = getToolbarIframe()\n  const transitionDuration = iframe.style.transitionDuration\n  setStyles(iframe, { \"height\": \"100%\", \"transition-duration\": \"0ms\" })\n  if (transitionDuration) {\n    setTimeout(() => {\n      setStyles(iframe, { \"transition-duration\": transitionDuration })\n    })\n  }\n}\n\nconst disableIframeOverflowOnParentWindow = () => {\n  if (!iframeOverflowEnabled) return\n  iframeOverflowEnabled = false\n\n  const iframe = getToolbarIframe()\n  const transitionDuration = iframe.style.transitionDuration\n  setStyles(iframe, { \"height\": \"40px\", \"transition-duration\": \"0ms\" })\n  if (transitionDuration) {\n    setTimeout(() => {\n      setStyles(iframe, { \"transition-duration\": transitionDuration })\n    })\n  }\n}\n\nexport const getToolbarIframe = () => {\n  const iframes = Array.from(window.parent.document.querySelectorAll(\"iframe\"))\n  return iframes.find((iframe) => iframe.contentWindow === window)\n}\n\nexport const forceHideElement = (element) => {\n  element.setAttribute(\"data-force-hide\", \"\")\n}\n\nexport const removeForceHideElement = (element) => {\n  element.removeAttribute(\"data-force-hide\")\n}\n\nexport const setStyles = (element, styles) => {\n  const elementStyle = element.style\n  const restoreStyles = Object.keys(styles).map((styleName) => {\n    let restore\n    if (styleName in elementStyle) {\n      const currentStyle = elementStyle[styleName]\n      restore = () => {\n        elementStyle[styleName] = currentStyle\n      }\n    } else {\n      restore = () => {\n        delete elementStyle[styleName]\n      }\n    }\n\n    elementStyle[styleName] = styles[styleName]\n\n    return restore\n  })\n  return () => {\n    restoreStyles.forEach((restore) => restore())\n  }\n}\n\nexport const setAttributes = (element, attributes) => {\n  Object.keys(attributes).forEach((name) => {\n    element.setAttribute(name, attributes[name])\n  })\n}\n\nexport const getDocumentScroll = () => {\n  return {\n    x: document.documentElement.scrollLeft,\n    y: document.documentElement.scrollTop,\n  }\n}\n\nexport const toolbarSectionIsActive = (element) => {\n  return element.hasAttribute(\"data-active\")\n}\n\nexport const activateToolbarSection = (element) => {\n  element.setAttribute(\"data-active\", \"\")\n}\n\nexport const deactivateToolbarSection = (element) => {\n  element.removeAttribute(\"data-active\")\n}\n",
    "import { fetchExploringJson } from \"@jsenv/core/src/internal/dev_server/exploring/fetch_exploring_json.js\"\n\nimport { setAttributes, setStyles } from \"./util/dom.js\"\n\n// eslint-disable-next-line no-undef\nconst TOOLBAR_BUILD_RELATIVE_URL = \"dist/toolbar/toolbar.html\"\nconst jsenvLogoSvgUrl = new URL(\"./jsenv_logo.svg\", import.meta.url)\n\nconst injectToolbar = async () => {\n  await new Promise((resolve) => {\n    if (window.requestIdleCallback) {\n      window.requestIdleCallback(resolve, { timeout: 400 })\n    } else {\n      window.requestAnimationFrame(resolve)\n    }\n  })\n  const exploringJSON = await fetchExploringJson()\n  const placeholder = getToolbarPlaceholder()\n\n  const iframe = document.createElement(\"iframe\")\n  setAttributes(iframe, {\n    tabindex: -1,\n    // sandbox: \"allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-same-origin allow-scripts allow-top-navigation-by-user-activation\",\n    // allow: \"accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; microphone; midi; payment; vr\",\n    allowtransparency: true,\n  })\n  setStyles(iframe, {\n    \"position\": \"fixed\",\n    \"zIndex\": 1000,\n    \"bottom\": 0,\n    \"left\": 0,\n    \"width\": \"100%\",\n    \"height\": 0,\n    /* ensure toolbar children are not focusable when hidden */\n    \"visibility\": \"hidden\",\n    \"transition-duration\": \"300ms\",\n    \"transition-property\": \"height, visibility\",\n    \"border\": \"none\",\n  })\n  const iframeLoadedPromise = iframeToLoadedPromise(iframe)\n  const jsenvCoreDirectoryServerUrl = new URL(\n    exploringJSON.jsenvCoreDirectoryRelativeUrl,\n    document.location.origin,\n  ).href\n  const jsenvToolbarHtmlServerUrl = new URL(\n    TOOLBAR_BUILD_RELATIVE_URL,\n    jsenvCoreDirectoryServerUrl,\n  )\n  // set iframe src BEFORE putting it into the DOM (prevent firefox adding an history entry)\n  iframe.setAttribute(\"src\", jsenvToolbarHtmlServerUrl)\n  placeholder.parentNode.replaceChild(iframe, placeholder)\n\n  addToolbarEventCallback(iframe, \"toolbar_ready\", () => {\n    sendCommandToToolbar(iframe, \"renderToolbar\", { exploringJSON })\n  })\n\n  await iframeLoadedPromise\n  iframe.removeAttribute(\"tabindex\")\n\n  const div = document.createElement(\"div\")\n  div.innerHTML = `\n<div id=\"jsenv-toolbar-trigger\">\n  <svg id=\"jsenv-toolbar-trigger-icon\">\n    <use xlink:href=\"${jsenvLogoSvgUrl}#jsenv_logo\"></use>\n  </svg>\n  <style>\n    #jsenv-toolbar-trigger {\n      display: block;\n      overflow: hidden;\n      position: fixed;\n      z-index: 1000;\n      bottom: -32px;\n      right: 20px;\n      height: 40px;\n      width: 40px;\n      padding: 0;\n      margin: 0;\n      border-radius: 5px 5px 0 0;\n      border: 1px solid rgba(0, 0, 0, 0.33);\n      border-bottom: none;\n      box-shadow: 0px 0px 6px 2px rgba(0, 0, 0, 0.46);\n      background: transparent;\n      text-align: center;\n      transition: 600ms;\n    }\n\n    #jsenv-toolbar-trigger:hover {\n      cursor: pointer;\n    }\n\n    #jsenv-toolbar-trigger[data-expanded] {\n      bottom: 0;\n    }\n\n    #jsenv-toolbar-trigger-icon {\n      width: 35px;\n      height: 35px;\n      opacity: 0;\n      transition: 600ms;\n    }\n\n    #jsenv-toolbar-trigger[data-expanded] #jsenv-toolbar-trigger-icon {\n      opacity: 1;\n    }\n  </style>\n</div>`\n  const toolbarTrigger = div.firstElementChild\n  iframe.parentNode.appendChild(toolbarTrigger)\n\n  let timer\n  toolbarTrigger.onmouseenter = () => {\n    toolbarTrigger.setAttribute(\"data-animate\", \"\")\n    timer = setTimeout(expandToolbarTrigger, 500)\n  }\n  toolbarTrigger.onmouseleave = () => {\n    clearTimeout(timer)\n    collapseToolbarTrigger()\n  }\n  toolbarTrigger.onfocus = () => {\n    toolbarTrigger.removeAttribute(\"data-animate\")\n    expandToolbarTrigger()\n  }\n  toolbarTrigger.onblur = () => {\n    toolbarTrigger.removeAttribute(\"data-animate\")\n    clearTimeout(timer)\n    collapseToolbarTrigger()\n  }\n  toolbarTrigger.onclick = () => {\n    sendCommandToToolbar(iframe, \"showToolbar\")\n  }\n\n  const showToolbarTrigger = () => {\n    toolbarTrigger.style.display = \"block\"\n  }\n\n  const hideToolbarTrigger = () => {\n    toolbarTrigger.style.display = \"none\"\n  }\n\n  const expandToolbarTrigger = () => {\n    toolbarTrigger.setAttribute(\"data-expanded\", \"\")\n  }\n\n  const collapseToolbarTrigger = () => {\n    toolbarTrigger.removeAttribute(\"data-expanded\", \"\")\n  }\n\n  hideToolbarTrigger()\n  addToolbarEventCallback(iframe, \"toolbar-visibility-change\", (visible) => {\n    if (visible) {\n      hideToolbarTrigger()\n    } else {\n      showToolbarTrigger()\n    }\n  })\n\n  return iframe\n}\n\nconst addToolbarEventCallback = (iframe, eventName, callback) => {\n  const messageEventCallback = (messageEvent) => {\n    const { data } = messageEvent\n    if (typeof data !== \"object\") {\n      return\n    }\n    const { __jsenv__ } = data\n    if (!__jsenv__) {\n      return\n    }\n    if (__jsenv__.event !== eventName) {\n      return\n    }\n    callback(__jsenv__.data)\n  }\n\n  window.addEventListener(\"message\", messageEventCallback, false)\n  return () => {\n    window.removeEventListener(\"message\", messageEventCallback, false)\n  }\n}\n\nconst sendCommandToToolbar = (iframe, command, ...args) => {\n  iframe.contentWindow.postMessage(\n    {\n      __jsenv__: {\n        command,\n        args,\n      },\n    },\n    window.origin,\n  )\n}\n\nconst getToolbarPlaceholder = () => {\n  const placeholder = queryPlaceholder()\n  if (placeholder) {\n    if (document.body.contains(placeholder)) {\n      return placeholder\n    }\n    // otherwise iframe would not be visible because in <head>\n    console.warn(\n      \"element with [data-jsenv-toolbar-placeholder] must be inside document.body\",\n    )\n    return createTooolbarPlaceholder()\n  }\n  return createTooolbarPlaceholder()\n}\n\nconst queryPlaceholder = () => {\n  return document.querySelector(\"[data-jsenv-toolbar-placeholder]\")\n}\n\nconst createTooolbarPlaceholder = () => {\n  const placeholder = document.createElement(\"span\")\n  document.body.appendChild(placeholder)\n  return placeholder\n}\n\nconst iframeToLoadedPromise = (iframe) => {\n  return new Promise((resolve) => {\n    const onload = () => {\n      iframe.removeEventListener(\"load\", onload, true)\n      resolve()\n    }\n    iframe.addEventListener(\"load\", onload, true)\n  })\n}\n\nif (document.readyState === \"complete\") {\n  injectToolbar()\n} else {\n  window.addEventListener(\"load\", injectToolbar)\n  // document.addEventListener(\"readystatechange\", () => {\n  //   if (document.readyState === \"complete\") {\n  //     injectToolbar()\n  //   }\n  // })\n}\n"
  ],
  "names": [
    "fetchUsingXHR",
    "url",
    "signal",
    "method",
    "credentials",
    "headers",
    "body",
    "headersPromise",
    "createPromiseAndHooks",
    "bodyPromise",
    "xhr",
    "XMLHttpRequest",
    "failure",
    "error",
    "settled",
    "reject",
    "cleanup",
    "ontimeout",
    "onerror",
    "onload",
    "onreadystatechange",
    "Error",
    "createRequestError",
    "resolve",
    "addEventListener",
    "abort",
    "abortError",
    "name",
    "readyState",
    "open",
    "Object",
    "keys",
    "forEach",
    "key",
    "setRequestHeader",
    "withCredentials",
    "computeWithCredentials",
    "hasBlob",
    "responseType",
    "send",
    "responseUrl",
    "responseURL",
    "responseStatus",
    "status",
    "responseStatusText",
    "statusText",
    "responseHeaders",
    "getHeadersFromXHR",
    "readBody",
    "response",
    "responseText",
    "responseBody",
    "responseBodyType",
    "detectBodyType",
    "text",
    "blobToText",
    "arrayBufferToText",
    "buffer",
    "String",
    "json",
    "JSON",
    "parse",
    "blob",
    "Blob",
    "cloneBuffer",
    "arrayBuffer",
    "responseBlob",
    "blobToArrayBuffer",
    "formData",
    "hasFormData",
    "textToFormData",
    "canUseBlob",
    "window",
    "FileReader",
    "e",
    "FormData",
    "hasArrayBuffer",
    "ArrayBuffer",
    "hasSearchParams",
    "URLSearchParams",
    "stack",
    "promise",
    "Promise",
    "res",
    "rej",
    "value",
    "originSameAsGlobalOrigin",
    "location",
    "globalOrigin",
    "origin",
    "hrefToOrigin",
    "prototype",
    "isPrototypeOf",
    "isDataView",
    "isArrayBufferView",
    "headerMap",
    "headersString",
    "getAllResponseHeaders",
    "lines",
    "trim",
    "split",
    "line",
    "parts",
    "shift",
    "join",
    "toLowerCase",
    "href",
    "scheme",
    "hrefToScheme",
    "secondProtocolSlashIndex",
    "length",
    "pathnameSlashIndex",
    "indexOf",
    "slice",
    "colonIndex",
    "obj",
    "DataView",
    "isView",
    "viewClasses",
    "includes",
    "toString",
    "call",
    "form",
    "bytes",
    "replace",
    "append",
    "decodeURIComponent",
    "reader",
    "fileReaderReady",
    "readAsArrayBuffer",
    "readAsText",
    "view",
    "Uint8Array",
    "chars",
    "Array",
    "i",
    "fromCharCode",
    "result",
    "byteLength",
    "set",
    "fetchNative",
    "mode",
    "options",
    "fetch",
    "responseToHeaders",
    "fetchUrl",
    "AbortController",
    "fetchJson",
    "object",
    "fetchExploringJson",
    "exploringInfo",
    "aborted",
    "setStyles",
    "element",
    "styles",
    "elementStyle",
    "style",
    "restoreStyles",
    "map",
    "styleName",
    "restore",
    "currentStyle",
    "setAttributes",
    "attributes",
    "setAttribute",
    "TOOLBAR_BUILD_RELATIVE_URL",
    "jsenvLogoSvgUrl",
    "injectToolbar",
    "requestIdleCallback",
    "timeout",
    "requestAnimationFrame",
    "exploringJSON",
    "placeholder",
    "getToolbarPlaceholder",
    "iframe",
    "document",
    "createElement",
    "tabindex",
    "allowtransparency",
    "iframeLoadedPromise",
    "iframeToLoadedPromise",
    "jsenvCoreDirectoryServerUrl",
    "URL",
    "jsenvCoreDirectoryRelativeUrl",
    "jsenvToolbarHtmlServerUrl",
    "parentNode",
    "replaceChild",
    "addToolbarEventCallback",
    "sendCommandToToolbar",
    "removeAttribute",
    "div",
    "innerHTML",
    "toolbarTrigger",
    "firstElementChild",
    "appendChild",
    "timer",
    "onmouseenter",
    "setTimeout",
    "expandToolbarTrigger",
    "onmouseleave",
    "clearTimeout",
    "collapseToolbarTrigger",
    "onfocus",
    "onblur",
    "onclick",
    "showToolbarTrigger",
    "display",
    "hideToolbarTrigger",
    "visible",
    "eventName",
    "callback",
    "messageEventCallback",
    "messageEvent",
    "data",
    "__jsenv__",
    "event",
    "removeEventListener",
    "command",
    "args",
    "contentWindow",
    "postMessage",
    "queryPlaceholder",
    "contains",
    "console",
    "warn",
    "createTooolbarPlaceholder",
    "querySelector"
  ],
  "mappings": "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"
}