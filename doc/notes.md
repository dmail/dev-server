### todo

retest how jsenv behaves when a subimported module throw
the idea is to be able to know what file cause the error
because while working on this I often had trouble to find which file
contained invalid syntax, require or an import which was not found

write test to ensure bundling works instead of having to see if output looks correct

### How to use dependency written in commonjs

Keep in mind that some module now have `module` or `jsnext:main` in their `package.json` leading to files written using `import/export`. In that case `importMap.json` generated by `generate-import-map` will contain a remapping to this file and you're good.

Otherwise if you want to use a npm module called `awesome` written using `module.exports`, you can

Use `import.meta.require` if you know your code is meant to be executed only on node:

```js
const awesome = import.meta.require("awesome")
```

Manually convert it to `import/export`:

- Fork the github repository
- Run an automatic tool to transform `module.exports` into `import/export`. For instance https://github.com/tbranyen/babel-plugin-transform-commonjs.
- Ensure dependency still works, you may run npm test for that.
- Open a PR with the code written using `import/export` or use your fork directly.

You can reuse this strategy for dependency written in iife, amd or umd.

## Generator not supported

Because we miss a strategy to provide regeneratorRuntime and polyfill in general.

## Sourcemap broken

It's likely because `transform-async-to-promises` used together with `transform-modules-systemjs` generate bad sourcemap.
It means if you use async/await in a platform not supporting it, your sourcemap will not be able to point the original location.
