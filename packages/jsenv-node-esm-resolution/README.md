TODO:

- add more unit tests
- improve error messages
