import{setStyles as t}from"/js/dom.js?v=4435f890";export const canUseAnimation=()=>"function"==typeof HTMLElement.prototype.animate;export const animateElement=canUseAnimation()?(t,e,{signal:o,...n}={})=>{const a=t.animate(e,n);return o&&o.addEventListener("abort",(()=>{a.cancel()})),new Promise((t=>{a.onfinish=t}))}:()=>Promise.resolve();export const fadeIn=(t,e)=>animateElement(t,[{opacity:0},{opacity:1}],e);export const fadeOut=(t,e)=>animateElement(t,[{opacity:1},{opacity:0}],e);export const move=(t,e,o)=>{const n=window.getComputedStyle(t),a=window.getComputedStyle(e),i=t.getBoundingClientRect(),r=e.getBoundingClientRect(),s=document.createElement("div");s.style.position="absolute",s.style.left=0,s.style.top=0,s.style.width="".concat(document.documentElement.scrollWidth,"px"),s.style.height="".concat(document.documentElement.scrollHeight,"px"),s.style.overflow="hidden",s.style.pointerEvents="none";const l=window.pageXOffset||document.documentElement.scrollLeft,c=window.pageYOffset||document.documentElement.scrollTop,p=t.cloneNode(!0);p.style.position="absolute",p.style.left="".concat(l+i.left,"px"),p.style.top="".concat(c+i.top,"px"),p.style.maxWidth="".concat(i.right-i.left,"px"),p.style.overflow=a.overflow,p.style.textOverflow=a.textOverflow,s.appendChild(p),document.body.appendChild(s);const m=r.left-i.left-(parseInt(n.paddingLeft)||0),d=r.top-i.top-(parseInt(n.paddingTop)||0),f="translate(".concat(m,"px, ").concat(d,"px)");return animateElement(p,[{transform:"translate(0px, 0px)",backgroundColor:n.backgroundColor,color:n.color,fontSize:n.fontSize,height:"".concat(i.bottom-i.top,"px"),width:"100%"},{offset:.9,backgroundColor:n.backgroundColor,color:n.color},{transform:f,backgroundColor:a.backgroundColor,color:a.color,fontSize:a.fontSize,height:"".concat(r.bottom-r.top,"px"),width:a.width}],o).then((()=>{s.parentNode.removeChild(s)}))};export const createToolbarAnimation=()=>{const t=transit({"#page":{paddingBottom:0},footer:{height:0},"#toolbar":{visibility:"hidden"}},{"#page":{paddingBottom:"40px"},footer:{height:"40px"},"#toolbar":{visibility:"visible"}},{duration:300});return{expand:()=>{t.play()},collapse:()=>{t.reverse()}}};export const transit=(e,o,{commitStyles:n=!0,fill:a="both",duration:i=300}={})=>{const r=[];Object.keys(e).forEach((t=>{const n={},s={},l=document.querySelector(t),c=[],p=e[t],m=o[t];let d;if(Object.keys(p).forEach((t=>{const e=p[t],o=m[t];n[t]=e,s[t]=o})),c.push(n,s),canUseAnimation()){const t=new KeyframeEffect(l,c,{fill:a,duration:i});d=new Animation(t)}else d={playbackRate:1,play:()=>{d.onfinish()},reverse:()=>{d.playbackRate=-1,d.onfinish()},finish:()=>{},onfinish:()=>{}};r.push({element:l,animation:d,fromStyles:n,toStyles:s})}));return{play:async()=>{await Promise.all(r.map((({animation:e,element:o,toStyles:a})=>new Promise((i=>{e.onfinish=()=>{n&&t(o,a),i()},-1===e.playbackRate?e.reverse():e.play()})))))},reverse:async()=>{await Promise.all(r.map((({animation:e,element:o,fromStyles:a})=>new Promise((i=>{e.onfinish=()=>{n&&t(o,a),i()},e.reverse()})))))},finish:async()=>{r.forEach((({animation:t})=>{t.finish()}))}}};export const startJavaScriptAnimation=({duration:t=300,timingFunction:e=(t=>t),onProgress:o=(()=>{}),onCancel:n=(()=>{}),onComplete:a=(()=>{})})=>{if(isNaN(t))return()=>{};t=parseInt(t,10);const i=performance.now();let r,s=!1,l=0,c=0;const p=()=>{r=null;const n=performance.now();l=Math.min((n-i)/t,1),c=e(l),s=1===l,o({done:s,rawProgress:l,progress:c}),s?a():r=window.requestAnimationFrame(p)};p();return()=>{r&&(window.cancelAnimationFrame(r),r=null),s||(s=!0,n({rawProgress:l,progress:c}))}};